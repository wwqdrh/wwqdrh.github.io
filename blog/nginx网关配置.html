<!DOCTYPE html><html lang="zh-CN"><head><meta name="viewport" content="width=device-width"/><title>nginx网关的常用配置</title><meta name="robots" content="follow, index"/><meta charSet="UTF-8"/><meta name="description" content="nginx网关的常用配置"/><meta property="og:type"/><meta property="og:title" content="nginx网关的常用配置"/><meta property="og:description" content="nginx网关的常用配置"/><meta property="og:url" content="https://wwqdrh.github.io/undefined"/><meta name="keywords" content="wwqdrh技术博客"/><meta property="og:locale" content="zh-CN"/><meta property="og:image" content="https://wwqdrh.github.io"/><meta name="twitter:title" content="nginx网关的常用配置"/><meta name="twitter:description" content="nginx网关的常用配置"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://wwqdrh.github.io"/><link rel="stylesheet" href="/assets/mdrender/editor-render.css"/><meta name="next-head-count" content="17"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="192x192" href="/apple-touch-icon.png"/><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/feed"/><script src="/assets/analizy/clarity.js"></script><link rel="preload" href="/_next/static/media/d83e92f0af8b17e4-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/ed42d1b51efd45f6-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/fba9d678ff638e59-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/e52907b750a6f61e-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/9031250013752d4b-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/eb9adf802b0a60eb-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/81b352a4d7a000ae-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/41b9b3ece820718f-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/d587d1c112526568-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/869c7de7c781f904.css" as="style"/><link rel="stylesheet" href="/_next/static/css/869c7de7c781f904.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-6ef43a8d4a395f49.js" defer=""></script><script src="/_next/static/chunks/framework-fbe37f60a09a330b.js" defer=""></script><script src="/_next/static/chunks/main-082d90b1269d95f6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-494ee9c4b0594b31.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-222bf60d0a2bf3df.js" defer=""></script><script src="/_next/static/PMB5qMppIrri5HN2Gb314/_buildManifest.js" defer=""></script><script src="/_next/static/PMB5qMppIrri5HN2Gb314/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global c86wz">body{margin:0;padding:0;color:hsl(0, 0%, 9.0%);background-color:hsl(0, 0%, 97.3%);font-family:'__pretendard_6bb8e5','__pretendard_Fallback_6bb8e5';}*{-webkit-print-color-scheme:light;color-scheme:light;box-sizing:border-box;}h1,h2,h3,h4,h5,h6{margin:0;font-weight:inherit;font-style:inherit;}a{all:unset;cursor:pointer;}ul{padding:0;}button{all:unset;cursor:pointer;}input{all:unset;box-sizing:border-box;}textarea{border:none;background-color:transparent;font-family:inherit;padding:0;outline:none;resize:none;color:inherit;}hr{width:100%;border:none;margin:0;border-top:1px solid hsl(0, 0%, 88.7%);}</style><style data-emotion="css 1q70a33">.css-1q70a33{z-index:30;position:-webkit-sticky;position:sticky;top:0;background-color:hsl(0, 0%, 97.3%);box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05);}.css-1q70a33 .container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:3rem;margin:0 auto;}@media (min-width: 768px){.css-1q70a33 .container[data-full-width="true"]{padding-left:6rem;padding-right:6rem;}}.css-1q70a33 .container .nav{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:0.75rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-1q70a33 .container .mid{padding-top:0.5rem;padding-bottom:0.5rem;padding-left:1.25rem;padding-right:1.25rem;border-radius:1rem;outline-style:none;width:50%;background-color:hsl(0, 0%, 93.0%);}</style><div class="py-2 css-1q70a33"><div data-full-width="false" class="container"><a aria-label="wwqdrh" class="css-0" href="/">wwqdrh</a><input class="mid" type="text" placeholder="Search Keyword..." value=""/><div class="nav"><style data-emotion="css 1nw6zn9">.css-1nw6zn9{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.css-1nw6zn9 ul{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-1nw6zn9 ul li{display:block;margin-left:1rem;color:hsl(0, 0%, 43.5%);}</style><div class="css-1nw6zn9"><ul><li><a target="_blank" href="https://space.bilibili.com/538676331">B站</a></li></ul></div><style data-emotion="css 1h5x3dy">.css-1h5x3dy{cursor:pointer;}</style><div class="css-1h5x3dy"><style data-emotion="css p95608">.css-p95608{font-family:'__Noto_Color_Emoji_be1378','__Noto_Color_Emoji_Fallback_be1378',Apple Color Emoji;font-weight:400;font-style:normal;}</style><span class="css-p95608">☀️</span></div></div></div></div><style data-emotion="css lomkhl">.css-lomkhl{margin:0 auto;width:100%;padding:0 3rem;}</style><main class="css-lomkhl"><div class="divide-y bg-white dark:bg-gray-700 p-6 shadow-lg rounded-lg mt-3 divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="max-w-none pt-10 pb-8 prose dark:prose-dark"><div><h2>配置静态文件服务</h2>
<pre><code class="hljs language-bash">apt-get install nginx

systemctl start nginx

systemctl enable nginx
</code></pre><p>配置静态文件映射</p>
<ul>
<li>/usr/sbin/nginx：主程序</li>
<li>/etc/nginx：存放配置文件</li>
<li>/usr/share/nginx：存放静态文件</li>
<li>/var/log/nginx：存放日志</li>
</ul>
<p>程序启动之后默认的文件路径在<code>/var/www/html</code>下面，所以把需要映射的文件直接放在这就行</p>
<p>如果要设置文件过期时间</p>
<pre><code class="hljs language-bash">expires 30s;
expires 30m;
expires 2h;
expires 30d;
</code></pre><h2>配置basic auth</h2>
<pre><code class="hljs language-bash">sh -c <span class="hljs-string">&quot;echo -n &#x27;wwqdrh:&#x27; &gt;&gt; /etc/nginx/.htpasswd&quot;</span>

sh -c <span class="hljs-string">&quot;openssl passwd -apr1 &gt;&gt; /etc/nginx/.htpasswd&quot;</span>

<span class="hljs-comment"># 查看结果</span>
cat /etc/nginx/.htpasswd
</code></pre><p>选择要授权的配置文件中，例如<code>/etc/nginx/sites-enabled/default</code></p>
<pre><code>auth_basic <span class="hljs-string">&quot;Restricted Content&quot;</span>;

auth_basic_user_file /etc/nginx/.<span class="hljs-property">htpasswd</span>;
</code></pre><h2>配置https</h2>
<p>使用<code>nginx -V</code>查看是否有<code>http_ssl_module</code>模块(一般安装都会有)</p>
<p>启用 SSL Session 缓存可以大大减少 TLS 的反复验证，减少 TLS 握手的 roundtrip。<br>虽然 session 缓存会占用一定内存，但是用 1M 的内存就可以缓存 4000 个连接，可以说是非常非常划算的。(但是设置最好设置50m，1m太小了东西都加载不出来)</p>
<pre><code class="hljs language-conf">listen <span class="hljs-number">443</span> ssl default_server;

listen [::]:<span class="hljs-number">443</span> ssl default_server;

ssl_certificate /opt/certs/zerossl-certs/certificate.crt;

ssl_certificate_key /opt/certs/zerossl-certs//private.key;

<span class="hljs-comment"># ssl_session_cache为off或者none 这两种情况下 是不会启用ssl的session缓存功能的 </span>
ssl_session_cache  shared:SSL:50m;

ssl_session_timeout  5m;

<span class="hljs-comment"># 配置支持哪些加密方式，可以通过openssl查看`openssl -v`列出所有详细套件</span>
ssl_ciphers  HIGH:!aNULL:!MD5;

<span class="hljs-comment"># 设置协商加密算法时，优先使用我们服务端的加密套件，而不是客户端浏览器的加密套件</span>
ssl_prefer_server_ciphers  on;
</code></pre><p>想将http的流量重定向到https上，但是由于没有域名，只有ip，但是在nginx上不管使用<code>$host</code>还是<code>$server_name</code>都过不来，都只能是内网的ip，所以这个ip只能写死了</p>
<pre><code class="hljs language-conf">server {
        listen <span class="hljs-number">80</span> default_server;
        listen [::]:<span class="hljs-number">80</span> default_server;

        server_name _;

        <span class="hljs-meta"># rewrite ^(.*) https:<span class="hljs-comment">//$server_name$1 permanent;</span></span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">301</span> https:<span class="hljs-comment">//43.142.26.74$request_uri;</span>
}
</code></pre><h2>配置限流与后端转发</h2>
<p>ngx_http_limit_req_module模块通过漏桶原理来限制单位时间内的请求数，一旦单位时间内请求数超过限制，就会返回503错误</p>
<pre><code class="hljs language-conf"><span class="hljs-string">limit_req_zone</span> <span class="hljs-string">$binary_remote_addr</span> <span class="hljs-string">zone=selfcardreq:10m</span> <span class="hljs-string">rate=100r/s;</span> <span class="hljs-comment"># 触发条件，所有访问ip 限制每秒10个请求</span>
<span class="hljs-string">limit_conn_zone</span> <span class="hljs-string">$binary_remote_addr</span> <span class="hljs-string">zone=selfcardconn:10m;</span> <span class="hljs-comment"># 触发条件</span>

<span class="hljs-string">server</span> {
  <span class="hljs-string">listen</span> <span class="hljs-number">8000</span><span class="hljs-string">;</span>
  <span class="hljs-string">server_name</span> <span class="hljs-string">~^(?&lt;user&gt;.+)\.selfcard\.com$;</span>
  
  <span class="hljs-string">location</span> <span class="hljs-string">/</span> {
    <span class="hljs-string">limit_req</span> <span class="hljs-string">zone=selfcardreq</span> <span class="hljs-string">burst=5</span> <span class="hljs-string">nodelay;</span>   <span class="hljs-comment"># 执行的动作,通过zone名字对应</span>
    <span class="hljs-string">limit_conn</span> <span class="hljs-string">selfcardconn</span> <span class="hljs-number">100</span><span class="hljs-string">;</span>    <span class="hljs-comment"># 限制同一时间内1个连接，超出的连接返回503</span>

    <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">Host</span> <span class="hljs-string">$host;</span>
    <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">X-Real-IP</span> <span class="hljs-string">$remote_addr;</span>
    <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">X-Forwarded-For</span> <span class="hljs-string">$proxy_add_x_forwarded_for;</span>
    <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">User</span> <span class="hljs-string">$user;</span>
    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">X-Application-Context;</span>

    <span class="hljs-string">set</span> <span class="hljs-string">$is_matched</span> <span class="hljs-number">0</span><span class="hljs-string">;</span>
    <span class="hljs-string">if</span> <span class="hljs-string">($user</span> <span class="hljs-type">!=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">)</span> {
        <span class="hljs-string">set</span> <span class="hljs-string">$is_matched</span> <span class="hljs-number">1</span><span class="hljs-string">;</span>
        <span class="hljs-string">proxy_pass</span> <span class="hljs-string">http://0.0.0.0:3000;</span>
    }

    <span class="hljs-comment"># 没有匹配到，跳转到默认页面</span>
    <span class="hljs-string">if</span> <span class="hljs-string">($is_matched</span> <span class="hljs-string">=</span> <span class="hljs-number">0</span><span class="hljs-string">)</span> {
        <span class="hljs-string">return</span> <span class="hljs-number">301</span> <span class="hljs-string">http://www.selfcard.com:8000;</span>
    }
  }
}
</code></pre></div></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"\u003ch2\u003e配置静态文件服务\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eapt-get install nginx\n\nsystemctl start nginx\n\nsystemctl enable nginx\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e配置静态文件映射\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e/usr/sbin/nginx：主程序\u003c/li\u003e\n\u003cli\u003e/etc/nginx：存放配置文件\u003c/li\u003e\n\u003cli\u003e/usr/share/nginx：存放静态文件\u003c/li\u003e\n\u003cli\u003e/var/log/nginx：存放日志\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e程序启动之后默认的文件路径在\u003ccode\u003e/var/www/html\u003c/code\u003e下面，所以把需要映射的文件直接放在这就行\u003c/p\u003e\n\u003cp\u003e如果要设置文件过期时间\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eexpires 30s;\nexpires 30m;\nexpires 2h;\nexpires 30d;\n\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003e配置basic auth\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esh -c \u003cspan class=\"hljs-string\"\u003e\u0026quot;echo -n \u0026#x27;wwqdrh:\u0026#x27; \u0026gt;\u0026gt; /etc/nginx/.htpasswd\u0026quot;\u003c/span\u003e\n\nsh -c \u003cspan class=\"hljs-string\"\u003e\u0026quot;openssl passwd -apr1 \u0026gt;\u0026gt; /etc/nginx/.htpasswd\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 查看结果\u003c/span\u003e\ncat /etc/nginx/.htpasswd\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e选择要授权的配置文件中，例如\u003ccode\u003e/etc/nginx/sites-enabled/default\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eauth_basic \u003cspan class=\"hljs-string\"\u003e\u0026quot;Restricted Content\u0026quot;\u003c/span\u003e;\n\nauth_basic_user_file /etc/nginx/.\u003cspan class=\"hljs-property\"\u003ehtpasswd\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003e配置https\u003c/h2\u003e\n\u003cp\u003e使用\u003ccode\u003enginx -V\u003c/code\u003e查看是否有\u003ccode\u003ehttp_ssl_module\u003c/code\u003e模块(一般安装都会有)\u003c/p\u003e\n\u003cp\u003e启用 SSL Session 缓存可以大大减少 TLS 的反复验证，减少 TLS 握手的 roundtrip。\u003cbr\u003e虽然 session 缓存会占用一定内存，但是用 1M 的内存就可以缓存 4000 个连接，可以说是非常非常划算的。(但是设置最好设置50m，1m太小了东西都加载不出来)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-conf\"\u003elisten \u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e ssl default_server;\n\nlisten [::]:\u003cspan class=\"hljs-number\"\u003e443\u003c/span\u003e ssl default_server;\n\nssl_certificate /opt/certs/zerossl-certs/certificate.crt;\n\nssl_certificate_key /opt/certs/zerossl-certs//private.key;\n\n\u003cspan class=\"hljs-comment\"\u003e# ssl_session_cache为off或者none 这两种情况下 是不会启用ssl的session缓存功能的 \u003c/span\u003e\nssl_session_cache  shared:SSL:50m;\n\nssl_session_timeout  5m;\n\n\u003cspan class=\"hljs-comment\"\u003e# 配置支持哪些加密方式，可以通过openssl查看`openssl -v`列出所有详细套件\u003c/span\u003e\nssl_ciphers  HIGH:!aNULL:!MD5;\n\n\u003cspan class=\"hljs-comment\"\u003e# 设置协商加密算法时，优先使用我们服务端的加密套件，而不是客户端浏览器的加密套件\u003c/span\u003e\nssl_prefer_server_ciphers  on;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e想将http的流量重定向到https上，但是由于没有域名，只有ip，但是在nginx上不管使用\u003ccode\u003e$host\u003c/code\u003e还是\u003ccode\u003e$server_name\u003c/code\u003e都过不来，都只能是内网的ip，所以这个ip只能写死了\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-conf\"\u003eserver {\n        listen \u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e default_server;\n        listen [::]:\u003cspan class=\"hljs-number\"\u003e80\u003c/span\u003e default_server;\n\n        server_name _;\n\n        \u003cspan class=\"hljs-meta\"\u003e# rewrite ^(.*) https:\u003cspan class=\"hljs-comment\"\u003e//$server_name$1 permanent;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e https:\u003cspan class=\"hljs-comment\"\u003e//43.142.26.74$request_uri;\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003e配置限流与后端转发\u003c/h2\u003e\n\u003cp\u003engx_http_limit_req_module模块通过漏桶原理来限制单位时间内的请求数，一旦单位时间内请求数超过限制，就会返回503错误\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-conf\"\u003e\u003cspan class=\"hljs-string\"\u003elimit_req_zone\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$binary_remote_addr\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ezone=selfcardreq:10m\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erate=100r/s;\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 触发条件，所有访问ip 限制每秒10个请求\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003elimit_conn_zone\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$binary_remote_addr\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ezone=selfcardconn:10m;\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 触发条件\u003c/span\u003e\n\n\u003cspan class=\"hljs-string\"\u003eserver\u003c/span\u003e {\n  \u003cspan class=\"hljs-string\"\u003elisten\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8000\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"hljs-string\"\u003eserver_name\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e~^(?\u0026lt;user\u0026gt;.+)\\.selfcard\\.com$;\u003c/span\u003e\n  \n  \u003cspan class=\"hljs-string\"\u003elocation\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/\u003c/span\u003e {\n    \u003cspan class=\"hljs-string\"\u003elimit_req\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ezone=selfcardreq\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eburst=5\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enodelay;\u003c/span\u003e   \u003cspan class=\"hljs-comment\"\u003e# 执行的动作,通过zone名字对应\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003elimit_conn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eselfcardconn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e;\u003c/span\u003e    \u003cspan class=\"hljs-comment\"\u003e# 限制同一时间内1个连接，超出的连接返回503\u003c/span\u003e\n\n    \u003cspan class=\"hljs-string\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eHost\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$host;\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eX-Real-IP\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$remote_addr;\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eX-Forwarded-For\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$proxy_add_x_forwarded_for;\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003eproxy_set_header\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eUser\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$user;\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003eproxy_hide_header\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eX-Application-Context;\u003c/span\u003e\n\n    \u003cspan class=\"hljs-string\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$is_matched\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e($user\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003e!=\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e)\u003c/span\u003e {\n        \u003cspan class=\"hljs-string\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e$is_matched\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"hljs-string\"\u003eproxy_pass\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttp://0.0.0.0:3000;\u003c/span\u003e\n    }\n\n    \u003cspan class=\"hljs-comment\"\u003e# 没有匹配到，跳转到默认页面\u003c/span\u003e\n    \u003cspan class=\"hljs-string\"\u003eif\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e($is_matched\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e)\u003c/span\u003e {\n        \u003cspan class=\"hljs-string\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e301\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttp://www.selfcard.com:8000;\u003c/span\u003e\n    }\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e","frontMatter":{"readingTime":{"text":"4 min read","minutes":3.755,"time":225300,"words":751},"slug":"nginx网关配置","fileName":"nginx网关配置.md","title":"nginx网关的常用配置","date":"2022-10-08T00:00:00.000Z","tags":["实践"],"draft":false,"summary":"nginx网关的常用配置"}},"prev":{"title":"ssh环境配置","date":"2022-10-08T00:00:00.000Z","tags":["实践"],"draft":false,"summary":"ssh环境配置","slug":"ssh环境配置"},"next":{"title":"git环境搭建","date":"2022-10-08T00:00:00.000Z","tags":["实践"],"draft":false,"summary":"私人git服务搭建","slug":"git服务器搭建"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["nginx网关配置"]},"buildId":"PMB5qMppIrri5HN2Gb314","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>