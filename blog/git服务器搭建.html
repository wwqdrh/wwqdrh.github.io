<!DOCTYPE html><html lang="zh-CN"><head><meta name="viewport" content="width=device-width"/><title>git环境搭建</title><meta name="robots" content="follow, index"/><meta charSet="UTF-8"/><meta name="description" content="私人git服务搭建"/><meta property="og:type"/><meta property="og:title" content="git环境搭建"/><meta property="og:description" content="私人git服务搭建"/><meta property="og:url" content="https://wwqdrh.github.io/undefined"/><meta name="keywords" content="wwqdrh技术博客"/><meta property="og:locale" content="zh-CN"/><meta property="og:image" content="https://wwqdrh.github.io"/><meta name="twitter:title" content="git环境搭建"/><meta name="twitter:description" content="私人git服务搭建"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://wwqdrh.github.io"/><link rel="stylesheet" href="/assets/mdrender/editor-render.css"/><meta name="next-head-count" content="17"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="192x192" href="/apple-touch-icon.png"/><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/feed"/><script src="/assets/analizy/clarity.js"></script><link rel="preload" href="/_next/static/media/d83e92f0af8b17e4-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/ed42d1b51efd45f6-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/fba9d678ff638e59-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/e52907b750a6f61e-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/9031250013752d4b-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/eb9adf802b0a60eb-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/81b352a4d7a000ae-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/41b9b3ece820718f-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/d587d1c112526568-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/869c7de7c781f904.css" as="style"/><link rel="stylesheet" href="/_next/static/css/869c7de7c781f904.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-6ef43a8d4a395f49.js" defer=""></script><script src="/_next/static/chunks/framework-fbe37f60a09a330b.js" defer=""></script><script src="/_next/static/chunks/main-082d90b1269d95f6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-494ee9c4b0594b31.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-222bf60d0a2bf3df.js" defer=""></script><script src="/_next/static/xycpTPo5G1XEQLx5GlDdu/_buildManifest.js" defer=""></script><script src="/_next/static/xycpTPo5G1XEQLx5GlDdu/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global c86wz">body{margin:0;padding:0;color:hsl(0, 0%, 9.0%);background-color:hsl(0, 0%, 97.3%);font-family:'__pretendard_6bb8e5','__pretendard_Fallback_6bb8e5';}*{-webkit-print-color-scheme:light;color-scheme:light;box-sizing:border-box;}h1,h2,h3,h4,h5,h6{margin:0;font-weight:inherit;font-style:inherit;}a{all:unset;cursor:pointer;}ul{padding:0;}button{all:unset;cursor:pointer;}input{all:unset;box-sizing:border-box;}textarea{border:none;background-color:transparent;font-family:inherit;padding:0;outline:none;resize:none;color:inherit;}hr{width:100%;border:none;margin:0;border-top:1px solid hsl(0, 0%, 88.7%);}</style><style data-emotion="css 1q70a33">.css-1q70a33{z-index:30;position:-webkit-sticky;position:sticky;top:0;background-color:hsl(0, 0%, 97.3%);box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05);}.css-1q70a33 .container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:3rem;margin:0 auto;}@media (min-width: 768px){.css-1q70a33 .container[data-full-width="true"]{padding-left:6rem;padding-right:6rem;}}.css-1q70a33 .container .nav{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:0.75rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-1q70a33 .container .mid{padding-top:0.5rem;padding-bottom:0.5rem;padding-left:1.25rem;padding-right:1.25rem;border-radius:1rem;outline-style:none;width:50%;background-color:hsl(0, 0%, 93.0%);}</style><div class="py-2 css-1q70a33"><div data-full-width="false" class="container"><a aria-label="wwqdrh" class="css-0" href="/">wwqdrh</a><input class="mid" type="text" placeholder="Search Keyword..." value=""/><div class="nav"><style data-emotion="css 1nw6zn9">.css-1nw6zn9{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.css-1nw6zn9 ul{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-1nw6zn9 ul li{display:block;margin-left:1rem;color:hsl(0, 0%, 43.5%);}</style><div class="css-1nw6zn9"><ul><li><a target="_blank" href="https://space.bilibili.com/538676331">B站</a></li></ul></div><style data-emotion="css 1h5x3dy">.css-1h5x3dy{cursor:pointer;}</style><div class="css-1h5x3dy"><style data-emotion="css p95608">.css-p95608{font-family:'__Noto_Color_Emoji_be1378','__Noto_Color_Emoji_Fallback_be1378',Apple Color Emoji;font-weight:400;font-style:normal;}</style><span class="css-p95608">☀️</span></div></div></div></div><style data-emotion="css lomkhl">.css-lomkhl{margin:0 auto;width:100%;padding:0 3rem;}</style><main class="css-lomkhl"><div class="divide-y bg-white dark:bg-gray-700 p-6 shadow-lg rounded-lg mt-3 divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="max-w-none pt-10 pb-8 prose dark:prose-dark"><div><p>添加用户组</p>
<pre><code class="hljs language-bash">groupadd git

useradd git -g git <span class="hljs-comment"># 使用adduser比较好，简单一点</span>

mkdir /home/git <span class="hljs-comment"># 使用useradd创建用户需要自己创建工作目录</span>

<span class="hljs-comment"># 这里之前用成了root，需要修改所有者</span>
chown -R git:git /home/git
</code></pre><p>创建证书登录</p>
<p>收集所有需要登录服务器的本地用户公钥，公钥位于id_rsa.pub文件中，把我们的公钥导入到/home/git/.ssh/authorized_keys文件里，一行一个。</p>
<pre><code class="hljs language-bash">su git

cd /home/git/

mkdir .ssh

chmod <span class="hljs-number">755</span> .ssh

touch .ssh/authorized_keys

chmod <span class="hljs-number">644</span> .ssh/authorized_keys

vim .ssh/authorized_keys <span class="hljs-comment"># 将自己电脑上的公钥添加进去</span>
</code></pre><p>出于安全考虑，第二步创建的git用户不允许登录shell，这可以通过编辑/etc/passwd文件完成</p>
<pre><code class="hljs language-bash"><span class="hljs-comment"># /etc/passwd</span>

git:x:<span class="hljs-number">1004</span>:<span class="hljs-number">1004</span>::/home/git:/<span class="hljs-built_in">bin</span>/bash

<span class="hljs-comment"># 修改</span>

git:x:<span class="hljs-number">1004</span>:<span class="hljs-number">1004</span>::/home/git:/usr/<span class="hljs-built_in">bin</span>/git-shell
</code></pre><pre><code class="hljs language-bash"><span class="hljs-comment"># 在服务器上创建裸仓库</span>

mkdir project

cd project

git init --bare specs.git

<span class="hljs-comment"># 设置好用户和用户组，避免没有权限</span>
chown -R git:git specs.git

<span class="hljs-comment"># 将本地仓库上传到远程</span>
git remote add origin ssh://git@<span class="hljs-number">43.142</span><span class="hljs-number">.26</span><span class="hljs-number">.74</span>:<span class="hljs-number">22</span>/home/git/project/specs.git
</code></pre></div></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"\u003cp\u003e添加用户组\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003egroupadd git\n\nuseradd git -g git \u003cspan class=\"hljs-comment\"\u003e# 使用adduser比较好，简单一点\u003c/span\u003e\n\nmkdir /home/git \u003cspan class=\"hljs-comment\"\u003e# 使用useradd创建用户需要自己创建工作目录\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# 这里之前用成了root，需要修改所有者\u003c/span\u003e\nchown -R git:git /home/git\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e创建证书登录\u003c/p\u003e\n\u003cp\u003e收集所有需要登录服务器的本地用户公钥，公钥位于id_rsa.pub文件中，把我们的公钥导入到/home/git/.ssh/authorized_keys文件里，一行一个。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003esu git\n\ncd /home/git/\n\nmkdir .ssh\n\nchmod \u003cspan class=\"hljs-number\"\u003e755\u003c/span\u003e .ssh\n\ntouch .ssh/authorized_keys\n\nchmod \u003cspan class=\"hljs-number\"\u003e644\u003c/span\u003e .ssh/authorized_keys\n\nvim .ssh/authorized_keys \u003cspan class=\"hljs-comment\"\u003e# 将自己电脑上的公钥添加进去\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e出于安全考虑，第二步创建的git用户不允许登录shell，这可以通过编辑/etc/passwd文件完成\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# /etc/passwd\u003c/span\u003e\n\ngit:x:\u003cspan class=\"hljs-number\"\u003e1004\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1004\u003c/span\u003e::/home/git:/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/bash\n\n\u003cspan class=\"hljs-comment\"\u003e# 修改\u003c/span\u003e\n\ngit:x:\u003cspan class=\"hljs-number\"\u003e1004\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1004\u003c/span\u003e::/home/git:/usr/\u003cspan class=\"hljs-built_in\"\u003ebin\u003c/span\u003e/git-shell\n\u003c/code\u003e\u003c/pre\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# 在服务器上创建裸仓库\u003c/span\u003e\n\nmkdir project\n\ncd project\n\ngit init --bare specs.git\n\n\u003cspan class=\"hljs-comment\"\u003e# 设置好用户和用户组，避免没有权限\u003c/span\u003e\nchown -R git:git specs.git\n\n\u003cspan class=\"hljs-comment\"\u003e# 将本地仓库上传到远程\u003c/span\u003e\ngit remote add origin ssh://git@\u003cspan class=\"hljs-number\"\u003e43.142\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.26\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.74\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e/home/git/project/specs.git\n\u003c/code\u003e\u003c/pre\u003e","frontMatter":{"readingTime":{"text":"2 min read","minutes":1.395,"time":83700,"words":279},"slug":"git服务器搭建","fileName":"git服务器搭建.md","title":"git环境搭建","date":"2022-10-08T00:00:00.000Z","tags":["实践"],"draft":false,"summary":"私人git服务搭建"}},"prev":{"title":"nginx网关的常用配置","date":"2022-10-08T00:00:00.000Z","tags":["实践"],"draft":false,"summary":"nginx网关的常用配置","slug":"nginx网关配置"},"next":{"title":"表达时间的格式","date":"2022-10-10T00:00:00.000Z","tags":["操作系统"],"draft":false,"summary":"表达时间的格式","slug":"时间格式"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["git服务器搭建"]},"buildId":"xycpTPo5G1XEQLx5GlDdu","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>