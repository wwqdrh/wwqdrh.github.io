<!DOCTYPE html><html lang="zh-CN"><head><meta name="viewport" content="width=device-width"/><title>golangå·¥ç¨‹åŒ–çºµè§ˆ</title><meta name="robots" content="follow, index"/><meta charSet="UTF-8"/><meta name="description" content="golangå·¥ç¨‹åŒ–æ‰€ç”¨åˆ°çš„å·¥å…·æ¦‚è§ˆ"/><meta property="og:type"/><meta property="og:title" content="golangå·¥ç¨‹åŒ–çºµè§ˆ"/><meta property="og:description" content="golangå·¥ç¨‹åŒ–æ‰€ç”¨åˆ°çš„å·¥å…·æ¦‚è§ˆ"/><meta property="og:url" content="https://wwqdrh.github.io/undefined"/><meta name="keywords" content="wwqdrhæŠ€æœ¯åšå®¢"/><meta property="og:locale" content="zh-CN"/><meta property="og:image" content="https://wwqdrh.github.io"/><meta name="twitter:title" content="golangå·¥ç¨‹åŒ–çºµè§ˆ"/><meta name="twitter:description" content="golangå·¥ç¨‹åŒ–æ‰€ç”¨åˆ°çš„å·¥å…·æ¦‚è§ˆ"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://wwqdrh.github.io"/><link rel="stylesheet" href="/assets/mdrender/editor-render.css"/><meta name="next-head-count" content="17"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="192x192" href="/apple-touch-icon.png"/><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/feed"/><script src="/assets/analizy/clarity.js"></script><link rel="preload" href="/_next/static/media/d83e92f0af8b17e4-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/e52907b750a6f61e-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/ed42d1b51efd45f6-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/9031250013752d4b-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/fba9d678ff638e59-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/eb9adf802b0a60eb-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/81b352a4d7a000ae-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/41b9b3ece820718f-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/d587d1c112526568-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/869c7de7c781f904.css" as="style"/><link rel="stylesheet" href="/_next/static/css/869c7de7c781f904.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-6ef43a8d4a395f49.js" defer=""></script><script src="/_next/static/chunks/framework-fbe37f60a09a330b.js" defer=""></script><script src="/_next/static/chunks/main-082d90b1269d95f6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ebc472ae118a2be0.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-222bf60d0a2bf3df.js" defer=""></script><script src="/_next/static/qwylQn0rAYfx_DG8FLkaO/_buildManifest.js" defer=""></script><script src="/_next/static/qwylQn0rAYfx_DG8FLkaO/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global c86wz">body{margin:0;padding:0;color:hsl(0, 0%, 9.0%);background-color:hsl(0, 0%, 97.3%);font-family:'__pretendard_6bb8e5','__pretendard_Fallback_6bb8e5';}*{-webkit-print-color-scheme:light;color-scheme:light;box-sizing:border-box;}h1,h2,h3,h4,h5,h6{margin:0;font-weight:inherit;font-style:inherit;}a{all:unset;cursor:pointer;}ul{padding:0;}button{all:unset;cursor:pointer;}input{all:unset;box-sizing:border-box;}textarea{border:none;background-color:transparent;font-family:inherit;padding:0;outline:none;resize:none;color:inherit;}hr{width:100%;border:none;margin:0;border-top:1px solid hsl(0, 0%, 88.7%);}</style><style data-emotion="css 1q70a33">.css-1q70a33{z-index:30;position:-webkit-sticky;position:sticky;top:0;background-color:hsl(0, 0%, 97.3%);box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05);}.css-1q70a33 .container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:3rem;margin:0 auto;}@media (min-width: 768px){.css-1q70a33 .container[data-full-width="true"]{padding-left:6rem;padding-right:6rem;}}.css-1q70a33 .container .nav{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:0.75rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-1q70a33 .container .mid{padding-top:0.5rem;padding-bottom:0.5rem;padding-left:1.25rem;padding-right:1.25rem;border-radius:1rem;outline-style:none;width:50%;background-color:hsl(0, 0%, 93.0%);}</style><div class="py-2 css-1q70a33"><div data-full-width="false" class="container"><a aria-label="wwqdrh" class="css-0" href="/">wwqdrh</a><input class="mid" type="text" placeholder="Search Keyword..." value=""/><div class="nav"><style data-emotion="css 1nw6zn9">.css-1nw6zn9{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.css-1nw6zn9 ul{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-1nw6zn9 ul li{display:block;margin-left:1rem;color:hsl(0, 0%, 43.5%);}</style><div class="css-1nw6zn9"><ul><li><a target="_blank" href="https://space.bilibili.com/538676331">Bç«™</a></li></ul></div><style data-emotion="css 1h5x3dy">.css-1h5x3dy{cursor:pointer;}</style><div class="css-1h5x3dy"><style data-emotion="css p95608">.css-p95608{font-family:'__Noto_Color_Emoji_be1378','__Noto_Color_Emoji_Fallback_be1378',Apple Color Emoji;font-weight:400;font-style:normal;}</style><span class="css-p95608">â˜€ï¸</span></div></div></div></div><style data-emotion="css lomkhl">.css-lomkhl{margin:0 auto;width:100%;padding:0 3rem;}</style><main class="css-lomkhl"><div class="divide-y bg-white dark:bg-gray-700 p-6 shadow-lg rounded-lg mt-3 divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="max-w-none pt-10 pb-8 prose dark:prose-dark"><div><h1>fmt</h1>
<p>ä»£ç é£æ ¼æ ¼å¼åŒ– gofmtã€go fmtæ ‡å‡†å·¥å…·</p>
<h1>vet</h1>
<p>æ•æ‰å¯èƒ½å‡ºç°çš„é”™è¯¯ æ ‡å‡†å·¥å…· ä¸€èˆ¬æ¥è¯´ç¼–è¾‘å™¨ä¾‹å¦‚vscodeéƒ½å·²ç»é›†æˆäº†è¿™äº›åŠŸèƒ½ï¼Œæ‰€ä»¥ä¸éœ€è¦å•ç‹¬æ£€æµ‹</p>
<p><code>go vet -all</code></p>
<p>vetä¸€èˆ¬æ˜¯æ£€æŸ¥</p>
<pre><code class="hljs language-go">package main 
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span> 

<span class="hljs-comment">// Prints out &quot;Super Mario 3&quot; </span>
func <span class="hljs-title function_">main</span>(<span class="hljs-params"></span>) { 
    game_version :=<span class="hljs-number">3</span> 
    fmt.<span class="hljs-title class_">Printf</span>(<span class="hljs-string">&quot;Super Mario %s\n&quot;</span>,game_version) 
    <span class="hljs-comment">// ./main.go:6:2: Printf format %s has arg 3 of wrong type int</span>
}
</code></pre><h1>lint</h1>
<p>ä»£ç é™æ€æ£€æŸ¥</p>
<p>golintã€golangci-lint</p>
<h2>golangci-lint</h2>
<blockquote>
<p>å‚è€ƒ: <a href="https://golangci-lint.run/usage/configuration/">https://golangci-lint.run/usage/configuration/</a></p>
</blockquote>
<p><code>golangci-lint run</code></p>
<p><code>.golangci.yaml</code>é…ç½®linté€‰é¡¹</p>
<h3>é…ç½®é¡¹</h3>
<p>run</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">run:</span>
  <span class="hljs-attr">concurrency:</span> <span class="hljs-number">4</span>
  <span class="hljs-attr">timeout:</span> <span class="hljs-string">5m</span>
  <span class="hljs-attr">issues-exit-code:</span> <span class="hljs-number">2</span>
  <span class="hljs-attr">tests:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">build-tags:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">mytag</span>
  <span class="hljs-attr">skip-dirs:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">src/external_libs</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">autogenerated_by_my_lib</span>
  <span class="hljs-attr">skip-dirs-use-default:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">skip-files:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;.*\\.my\\.go$&quot;</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">lib/bad.go</span>
  <span class="hljs-attr">modules-download-mode:</span> <span class="hljs-string">readonly</span> <span class="hljs-comment"># readonly|vendor|mod</span>
  <span class="hljs-attr">allow-parallel-runners:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># If false (default) - golangci-lint acquires file lock on start.</span>
  <span class="hljs-attr">go:</span> <span class="hljs-string">&#x27;1.18&#x27;</span>
</code></pre><p>output</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">output:</span>
  <span class="hljs-attr">format:</span> <span class="hljs-string">json</span> <span class="hljs-comment"># colored-line-number|line-number|json|tab|checkstyle|code-climate|junit-xml|github-actions</span>
  <span class="hljs-attr">print-issued-lines:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">print-linter-name:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">uniq-by-line:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">path-prefix:</span> <span class="hljs-string">&quot;&quot;</span>
  <span class="hljs-attr">sort-results:</span> <span class="hljs-literal">false</span>
</code></pre><p>linters</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">linters:</span>
  <span class="hljs-attr">disable-all:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># Default: false</span>
  <span class="hljs-comment"># Enable specific linter</span>
  <span class="hljs-comment"># https://golangci-lint.run/usage/linters/#enabled-by-default</span>
  <span class="hljs-attr">enable:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">asasalint</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">asciicheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">bidichk</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">bodyclose</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">containedctx</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">contextcheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">cyclop</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">deadcode</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">decorder</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">depguard</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">dogsled</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">dupl</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">dupword</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">durationcheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">errcheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">errchkjson</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">errname</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">errorlint</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">execinquery</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">exhaustive</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">exhaustivestruct</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">exhaustruct</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">exportloopref</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">forbidigo</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">forcetypeassert</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">funlen</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gci</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gochecknoglobals</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gochecknoinits</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gocognit</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">goconst</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gocritic</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gocyclo</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">godot</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">godox</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">goerr113</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gofmt</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gofumpt</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">goheader</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">goimports</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">golint</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gomnd</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gomoddirectives</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gomodguard</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">goprintffuncname</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gosec</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">gosimple</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">govet</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">grouper</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">ifshort</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">importas</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">ineffassign</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">interfacebloat</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">interfacer</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">ireturn</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">lll</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">loggercheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">maintidx</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">makezero</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">maligned</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">misspell</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nakedret</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nestif</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nilerr</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nilnil</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nlreturn</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">noctx</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nolintlint</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nonamedreturns</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nosnakecase</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">nosprintfhostport</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">paralleltest</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">prealloc</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">predeclared</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">promlinter</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">reassign</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">revive</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">rowserrcheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">scopelint</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">sqlclosecheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">staticcheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">structcheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">stylecheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">tagliatelle</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">tenv</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">testableexamples</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">testpackage</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">thelper</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">tparallel</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">typecheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">unconvert</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">unparam</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">unused</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">usestdlibvars</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">varcheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">varnamelen</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">wastedassign</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">whitespace</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">wrapcheck</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">wsl</span>
  <span class="hljs-attr">enable-all:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># Default: false</span>
  <span class="hljs-attr">disable:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-comment"># åŒenableé¡¹ä¸€æ ·</span>
  <span class="hljs-comment"># Enable presets.</span>
  <span class="hljs-comment"># https://golangci-lint.run/usage/linters</span>
  <span class="hljs-attr">presets:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">bugs</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">comment</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">complexity</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">error</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">format</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">import</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">metalinter</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">module</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">performance</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">sql</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">style</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">test</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">unused</span>
  <span class="hljs-comment"># Run only fast linters from enabled linters set (first run won&#x27;t be fast)</span>
  <span class="hljs-comment"># Default: false</span>
  <span class="hljs-attr">fast:</span> <span class="hljs-literal">true</span>
</code></pre><p>issues</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">issues:</span>
  <span class="hljs-attr">exclude:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">abcdef</span>
  <span class="hljs-comment"># Excluding configuration per-path, per-linter, per-text and per-source</span>
  <span class="hljs-attr">exclude-rules:</span>
    <span class="hljs-comment"># Exclude some linters from running on tests files.</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">path:</span> <span class="hljs-string">_test\.go</span>
      <span class="hljs-attr">linters:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">gocyclo</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">errcheck</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">dupl</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">gosec</span>
    <span class="hljs-comment"># Exclude known linters from partially hard-vendored code,</span>
    <span class="hljs-comment"># which is impossible to exclude via `nolint` comments.</span>
    <span class="hljs-comment"># `/` will be replaced by current OS file path separator to properly work on Windows.</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">path:</span> <span class="hljs-string">internal/hmac/</span>
      <span class="hljs-attr">text:</span> <span class="hljs-string">&quot;weak cryptographic primitive&quot;</span>
      <span class="hljs-attr">linters:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">gosec</span>
    <span class="hljs-comment"># Exclude some `staticcheck` messages.</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">linters:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">staticcheck</span>
      <span class="hljs-attr">text:</span> <span class="hljs-string">&quot;SA9003:&quot;</span>
    <span class="hljs-comment"># Exclude `lll` issues for long lines with `go:generate`.</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">linters:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">lll</span>
      <span class="hljs-attr">source:</span> <span class="hljs-string">&quot;^//go:generate &quot;</span>
  <span class="hljs-attr">exclude-use-default:</span> <span class="hljs-literal">false</span>
  <span class="hljs-attr">exclude-case-sensitive:</span> <span class="hljs-literal">false</span>
  <span class="hljs-comment"># The list of ids of default excludes to include or disable.</span>
  <span class="hljs-comment"># https://golangci-lint.run/usage/false-positives/#default-exclusions</span>
  <span class="hljs-comment"># Default: []</span>
  <span class="hljs-attr">include:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0001</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0002</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0003</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0004</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0005</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0006</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0007</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0008</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0009</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0010</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0011</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0012</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0013</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0014</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">EXC0015</span>
  <span class="hljs-comment"># Maximum issues count per one linter.</span>
  <span class="hljs-comment"># Set to 0 to disable.</span>
  <span class="hljs-comment"># Default: 50</span>
  <span class="hljs-attr">max-issues-per-linter:</span> <span class="hljs-number">0</span>
  <span class="hljs-comment"># Maximum count of issues with the same text.</span>
  <span class="hljs-comment"># Set to 0 to disable.</span>
  <span class="hljs-comment"># Default: 3</span>
  <span class="hljs-attr">max-same-issues:</span> <span class="hljs-number">0</span>
  <span class="hljs-comment"># Show only new issues: if there are unstaged changes or untracked files,</span>
  <span class="hljs-comment"># only those changes are analyzed, else only changes in HEAD~ are analyzed.</span>
  <span class="hljs-comment"># It&#x27;s a super-useful option for integration of golangci-lint into existing large codebase.</span>
  <span class="hljs-comment"># It&#x27;s not practical to fix all existing issues at the moment of integration:</span>
  <span class="hljs-comment"># much better don&#x27;t allow issues in new code.</span>
  <span class="hljs-comment">#</span>
  <span class="hljs-comment"># Default: false.</span>
  <span class="hljs-attr">new:</span> <span class="hljs-literal">true</span>
  <span class="hljs-comment"># Show only new issues created after git revision `REV`.</span>
  <span class="hljs-attr">new-from-rev:</span> <span class="hljs-string">HEAD</span>
  <span class="hljs-comment"># Show only new issues created in git patch with set file path.</span>
  <span class="hljs-attr">new-from-patch:</span> <span class="hljs-string">path/to/patch/file</span>
  <span class="hljs-comment"># Fix found issues (if it&#x27;s supported by the linter).</span>
  <span class="hljs-attr">fix:</span> <span class="hljs-literal">true</span>
</code></pre><p>severity</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">severity:</span>
  <span class="hljs-attr">default-severity:</span> <span class="hljs-string">error</span>
  <span class="hljs-attr">case-sensitive:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">rules:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">linters:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">dupl</span>
      <span class="hljs-attr">severity:</span> <span class="hljs-string">info</span>
</code></pre><h1>å•å…ƒæµ‹è¯•</h1>
<p>åœ¨å•å…ƒæµ‹è¯•é¢†åŸŸï¼Œå…³äºå¦‚ä½•æ›¿æ¢æ‰å¤–éƒ¨ä¾èµ–ï¼Œä¸»è¦æœ‰ä¸¤ç§æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ mock å’Œ stubï¼šmock é€šè¿‡æ¥å£å¯ä»¥åŠ¨æ€è°ƒæ•´å¤–éƒ¨ä¾èµ–çš„è¿”å›å€¼ï¼Œè€Œ stub åªèƒ½åœ¨è¿è¡Œæ—¶é™æ€è°ƒæ•´å¤–éƒ¨ä¾èµ–çš„è¿”å›å€¼</p>
<blockquote>
<p>ä½¿ç”¨è¿™äº›éƒ½æ˜¯å°±æ˜¯ä¸ºäº†æ›¿æ¢å¤–éƒ¨ä¾èµ–æ—¶å€™ä½¿ç”¨çš„ï¼Œåªæ˜¯ä¸ºäº†å•å…ƒæµ‹è¯•è¦†ç›–ç‡å˜é«˜ä¸€ç‚¹ğŸ˜¹</p>
</blockquote>
<pre><code class="hljs language-bash">github.com/stretchr/testify/<span class="hljs-keyword">assert</span>

github.com/smartystreets/goconvey/convey

github.com/golang/mock/gomock
</code></pre><p><code>go install github.com/golang/mock/mockgen@latest</code></p>
<h2>gotest</h2>
<p>å®˜æ–¹å†…ç½®çš„å·¥å…·</p>
<ul>
<li>æ€§èƒ½æµ‹è¯•</li>
</ul>
<p><code>go test -bench</code></p>
<p>å®šä¹‰Benchå¼€å¤´çš„æµ‹è¯•å‡½æ•°</p>
<ul>
<li>è¦†ç›–ç‡</li>
</ul>
<p><code>go test -cover</code></p>
<ul>
<li>ç«æ€æ£€æŸ¥</li>
</ul>
<p><code>go test -race</code>ç”¨äºæ£€æŸ¥ä»£ç ä¸­æ˜¯å¦å­˜åœ¨å¹¶å‘å®‰å…¨é—®é¢˜</p>
<h2>testify</h2>
<ul>
<li>assert</li>
<li>require(ä¸assertä¸€æ ·ï¼Œä¸è¿‡å¼‚å¸¸ä¼šé€€å‡º)</li>
<li>mock</li>
</ul>
<blockquote>
<p>åœ¨è¦ç¼–å†™ä¸€ä¸ªä»ä¸€ä¸ªç«™ç‚¹æ‹‰å–ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯çš„ç¨‹åºï¼Œæ‹‰å–å®Œæˆä¹‹åç¨‹åºæ˜¾ç¤ºå’Œåˆ†æã€‚å¦‚æœæ¯æ¬¡éƒ½å»è®¿é—®ç½‘ç»œä¼šå¸¦æ¥æå¤§çš„ä¸ç¡®å®šæ€§ï¼Œç”šè‡³æ¯æ¬¡è¿”å›ä¸åŒçš„åˆ—è¡¨ï¼Œè¿™å°±ç»™æµ‹è¯•å¸¦æ¥äº†æå¤§çš„å›°éš¾ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Mock æŠ€æœ¯ã€‚</p>
</blockquote>
<p>ä½†æ˜¯é—®é¢˜åœ¨äºå¦‚æœç›´æ¥ä½¿ç”¨æ–°çš„æ¥å£è¿›è¡Œäº†æ›¿æ¢ï¼Œé‚£ä¹ˆä¼šå¯¼è‡´æœ‰äº›ä»£ç åˆ†æ”¯è¿›å…¥ä¸åˆ°ï¼Œè¦†ç›–ç‡é™ä½</p>
<ul>
<li>suite</li>
</ul>
<h2>gomock</h2>
<p><code>go mock</code></p>
<pre><code class="hljs language-bash">go get -u github.com/golang/mock/gomock go get -u github.com/golang/mock/mockgen
</code></pre><p>è¦ä½¿ç”¨gomockçš„ä¸€ä¸ªå‰ææ˜¯æ¨¡å—ä¹‹é—´åŠ¡å¿…é€šè¿‡æ¥å£è¿›è¡Œä¾èµ–ï¼Œè€Œä¸æ˜¯ä¾èµ–å…·ä½“å®ç°ï¼Œå¦åˆ™mockä¼šéå¸¸å›°éš¾ã€‚è¿™ä¸ªå·¥å…·ç›®å‰ä¸šç•Œç”¨çš„å¹¶ä¸å¤šï¼Œä¸»è¦æ˜¯å±€é™æ€§å¤ªå¤§</p>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå½“éœ€è¦è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼Œå¾€å¾€ä¼šæœ‰å¾ˆå¤šçš„ä¾èµ–é¡¹ï¼Œæœ‰äº›ä¾èµ–å¯èƒ½è¿˜æ²¡æœ‰åŠæ³•ç›´æ¥è¿›è¡Œåˆ›å»ºï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥ï¼Œæ–‡ä»¶ I/O ç­‰ã€‚æ­¤æ—¶é€šè¿‡ä½¿ç”¨ go mock å¯ä»¥æ¨¡æ‹Ÿä¾èµ–é¡¹ï¼Œç®€åŒ–æµ‹è¯•ã€‚</p>
<p><strong>æ¡©</strong>ï¼Œæˆ–ç§°æ¡©ä»£ç ï¼Œæ˜¯æŒ‡ç”¨æ¥ä»£æ›¿å…³è”ä»£ç æˆ–è€…æœªå®ç°ä»£ç çš„ä»£ç ã€‚å¦‚æœå‡½æ•° B ç”¨ B1 æ¥ä»£æ›¿ï¼Œé‚£ä¹ˆï¼ŒB ç§°ä¸ºåŸå‡½æ•°ï¼ŒB1 ç§°ä¸ºæ¡©å‡½æ•°ã€‚æ‰“æ¡©å°±æ˜¯ç¼–å†™æˆ–ç”Ÿæˆæ¡©ä»£ç ã€‚</p>
<h2>gostub</h2>
<p><code>go get github.com/prashantv/gostub</code></p>
<ul>
<li>ä¸ºä¸€ä¸ªå…¨å±€å˜é‡æ‰“æ¡©</li>
<li>ä¸ºä¸€ä¸ªå‡½æ•°æ‰“æ¡©</li>
<li>ä¸ºä¸€ä¸ªè¿‡ç¨‹æ‰“æ¡©</li>
<li>ç”±ä»»æ„ç›¸åŒæˆ–ä¸åŒçš„åŸºæœ¬åœºæ™¯ç»„åˆè€Œæˆ</li>
</ul>
<pre><code class="hljs language-go">func <span class="hljs-title class_">TestStubMethod</span>(t *testing.<span class="hljs-property">T</span>) {
    <span class="hljs-keyword">var</span> printStr = <span class="hljs-title function_">func</span>(val string) string {
        <span class="hljs-keyword">return</span> val
    }

    <span class="hljs-comment">// é’ˆå¯¹æœ‰å‚æ•°æœ‰è¿”å›å€¼çš„</span>
    stubs := gostub.<span class="hljs-title class_">Stub</span>(&amp;printStr, <span class="hljs-title function_">func</span>(val string) string {
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello,&quot;</span> + val
    })
    defer stubs.<span class="hljs-title class_">Reset</span>()
    fmt.<span class="hljs-title class_">Println</span>(<span class="hljs-string">&quot;After stub: &quot;</span>, <span class="hljs-title function_">printStr</span>(<span class="hljs-string">&quot;hhhhh&quot;</span>))

    <span class="hljs-keyword">var</span> printStr2 = <span class="hljs-title function_">func</span>(val string) string {
        <span class="hljs-keyword">return</span> val
    }
    <span class="hljs-comment">// StubFunc ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°å˜é‡çš„æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘çš„å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°å˜é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•° mock çš„è¿”å›å€¼</span>
    stubs2 := gostub.<span class="hljs-title class_">StubFunc</span>(&amp;printStr2, <span class="hljs-string">&quot;ddddd,ä¸‡ç”Ÿä¸–ä»£&quot;</span>)
    defer stubs2.<span class="hljs-title class_">Reset</span>()
    fmt.<span class="hljs-title class_">Println</span>(<span class="hljs-string">&quot;After stub:&quot;</span>, <span class="hljs-title function_">printStr2</span>(<span class="hljs-string">&quot;lalala&quot;</span>))
}
</code></pre><h2>gomonkey</h2>
<p><code>github.com/agiledragon/gomonkey/v2</code></p>
<p>1ã€å®ƒè¿åäº†å¼€é—­åŸåˆ™ã€‚
2ã€è¿è¡Œæ—¶å¿…é¡»å…³é—­å†…è¿ã€Œgo test -gcflags=all=-lã€ã€‚
3ã€è¿è¡Œæ—¶éœ€è¦å¾ˆé«˜çš„æƒé™ï¼Œå¹¶ä¸”ä¸åŒçš„ç¡¬ä»¶éœ€è¦ä¸åŒçš„é»‘ç§‘æŠ€å®ç°</p>
<ol>
<li>ç›´æ¥åœ¨æ–¹æ³•çº§åˆ«ä¸Šè¿›è¡Œ mock<br>ï¼ˆåœ¨è¿è¡Œæ—¶é€šè¿‡æ±‡ç¼–è¯­å¥é‡å†™å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå°†å¾…æ‰“æ¡©å‡½æ•°æˆ–æ–¹æ³•çš„å®ç°è·³è½¬åˆ°æ¡©å®ç°ï¼‰<br>åœ¨ç¼–è¯‘é˜¶æ®µç›´æ¥æ›¿æ¢æ‰çœŸçš„å‡½æ•°ä»£ç éƒ¨åˆ†  </li>
<li>éçº¿ç¨‹å®‰å…¨ï¼Œè¯·å‹¿ç”¨äºå¹¶å‘æµ‹è¯•</li>
</ol>
<p>å¹¶ä¸”å¿…é¡»åŠ ä¸Š<code>&quot;-gcflags=all=-l&quot;</code>, é¿å…å†…è”ä¼˜åŒ–(çŸ­å‡½æ•°ç›´æ¥è¢«åˆå¹¶ä¸ä¼šå•ç‹¬ä½œä¸ºä¸€ä¸ªå‡½æ•°)å¯¼è‡´æµ‹è¯•å¤±è´¥</p>
<pre><code class="hljs language-go">func DoSomething(name string, args ...string) (string, error) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>, errors.New(<span class="hljs-string">&quot;TODO&quot;</span>)
}

func TestExec(t *testing.T) {
    patches := gomonkey.NewPatches()
    defer patches.Reset()
    outputExpect := <span class="hljs-string">&quot;xxx-vethName100-yyy&quot;</span>
    guard := patches.ApplyFunc(DoSomething, func(_ string, _ ...string) (string, error) {
        <span class="hljs-keyword">return</span> outputExpect, nil
    })
    defer guard.Reset()
    output, err := DoSomething(<span class="hljs-string">&quot;asd&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>)
    <span class="hljs-keyword">assert</span>.Nil(t, err)
    <span class="hljs-keyword">assert</span>.Equal(t, outputExpect, output)
}
</code></pre><h2>httpæµ‹è¯•</h2>
<p>åœ¨ web é¡¹ç›®ä¸­ï¼Œå¤§å¤šæ¥å£æ˜¯å¤„ç† http è¯·æ±‚ï¼ˆpostã€get ä¹‹ç±»çš„ï¼‰ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œæ˜¯è®¿é—®ä¸åˆ°å®ƒå‘èµ·çš„ get è¯·æ±‚çš„ url çš„ï¼Œæ­¤æ—¶å°±å¯ä»¥æ¨¡æ‹Ÿ http è¯·æ±‚æ¥å†™æµ‹è¯•ã€‚å¯ä»¥åˆ©ç”¨å®˜æ–¹è‡ªå¸¦çš„ http åŒ…æ¥è¿›è¡Œæ¨¡æ‹Ÿè¯·æ±‚ã€‚</p>
<h2>sqlæµ‹è¯•</h2>
<p>æ¨¡æ‹Ÿä»»ä½•å®ç°äº† sql/driver æ¥å£çš„ db é©±åŠ¨ï¼Œæ— éœ€å…³æ³¨ db è¿æ¥ã€‚</p>
<h1>æ€§èƒ½è°ƒä¼˜</h1>
<p>ä½¿ç”¨goå†…ç½®çš„å·¥å…·pprofå³å¯åˆ†æç¨‹åºè¿è¡ŒçŠ¶æ€çš„æ•´ä½“æƒ…å†µ</p>
<table>
<thead>
<tr>
<th>allocs</th>
<th>å†…å­˜åˆ†é…æƒ…å†µçš„é‡‡æ ·ä¿¡æ¯</th>
</tr>
</thead>
<tbody><tr>
<td>blocks</td>
<td>é˜»å¡æ“ä½œæƒ…å†µçš„é‡‡æ ·ä¿¡æ¯</td>
</tr>
<tr>
<td>cmdline</td>
<td>ç¨‹åºå¯åŠ¨å‘½ä»¤å‚æ•°</td>
</tr>
<tr>
<td>goroutine</td>
<td>æ‰€æœ‰åç¨‹çš„å †æ ˆä¿¡æ¯</td>
</tr>
<tr>
<td>heap</td>
<td>å †ä¸Šçš„å†…å­˜åˆ†é…æƒ…å†µ</td>
</tr>
<tr>
<td>mutex</td>
<td>é”ç«äº‰æƒ…å†µçš„é‡‡æ ·ä¿¡æ¯</td>
</tr>
<tr>
<td>profile</td>
<td>cpuå ç”¨æƒ…å†µçš„é‡‡æ ·ä¿¡æ¯</td>
</tr>
<tr>
<td>threadcreate</td>
<td>ç³»ç»Ÿçº¿ç¨‹åˆ›å»ºæƒ…å†µçš„é‡‡æ ·ä¿¡æ¯</td>
</tr>
<tr>
<td>trace</td>
<td>ç¨‹åºè¿è¡Œè·Ÿè¸ªä¿¡æ¯</td>
</tr>
</tbody></table>
<ul>
<li>runtim/pprof: æ‰‹åŠ¨è°ƒç”¨ï¼Œä¸€èˆ¬åœ¨å‡½æ•°å…¥å£ä¸­</li>
<li>net/http/pprof: ç”¨äºwebç³»ç»Ÿä¸­ï¼Œä¸è¿‡åªæ˜¯å¯¹runtime/pprofçš„ç®€å•å°è£…</li>
<li>gin-contribæä¾›äº†å¯¹net/http/pprofçš„å°è£…ï¼Œèƒ½å¤Ÿåœ¨ginä¸­ä½¿ç”¨</li>
</ul>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œprofileæ‰€æ˜¾ç¤ºçš„æ—¶é—´æ˜æ˜¾å°äºæ¥å£è°ƒç”¨çš„æ—¶é—´ï¼Œæ˜¯å› ä¸ºprofileåªèƒ½å¤Ÿåˆ†æcpuçš„è€—æ—¶ï¼Œæ— æ³•è®¡ç®—ioæƒ…å†µ(å› ä¸ºioä¸ä¼šå ç”¨cpu)</p>
</blockquote>
<pre><code class="hljs language-bash"><span class="hljs-comment"># ä¸‹è½½cpu profileï¼Œé»˜è®¤ä»å½“å‰å¼€å§‹æ”¶é›†30sçš„cpuä½¿ç”¨æƒ…å†µï¼Œéœ€è¦ç­‰å¾…30s</span>
<span class="hljs-string">go</span> <span class="hljs-string">tool</span> <span class="hljs-string">pprof</span> <span class="hljs-string">http://localhost:6060/debug/pprof/profile</span>   <span class="hljs-comment"># 30-second CPU profile</span>
<span class="hljs-string">go</span> <span class="hljs-string">tool</span> <span class="hljs-string">pprof</span> <span class="hljs-string">http://localhost:6060/debug/pprof/profile?seconds=120</span>     <span class="hljs-comment"># wait 120s</span>

<span class="hljs-comment"># ä¸‹è½½heap profile</span>
<span class="hljs-string">go</span> <span class="hljs-string">tool</span> <span class="hljs-string">pprof</span> <span class="hljs-string">http://localhost:6060/debug/pprof/heap</span>      <span class="hljs-comment"># heap profile</span>

<span class="hljs-comment"># ä¸‹è½½goroutine profile</span>
<span class="hljs-string">go</span> <span class="hljs-string">tool</span> <span class="hljs-string">pprof</span> <span class="hljs-string">http://localhost:6060/debug/pprof/goroutine</span> <span class="hljs-comment"># goroutine profile</span>

<span class="hljs-comment"># ä¸‹è½½block profile</span>
<span class="hljs-string">go</span> <span class="hljs-string">tool</span> <span class="hljs-string">pprof</span> <span class="hljs-string">http://localhost:6060/debug/pprof/block</span>     <span class="hljs-comment"># goroutine blocking profile</span>

<span class="hljs-comment"># ä¸‹è½½mutex profile</span>
<span class="hljs-string">go</span> <span class="hljs-string">tool</span> <span class="hljs-string">pprof</span> <span class="hljs-string">http://localhost:6060/debug/pprof/mutex</span>
</code></pre><h2>trace</h2>
<p>traceå·¥å…·ï¼Œç”¨äºæŸ¥çœ‹æ•´ä¸ªå‘¨æœŸå†…å‘ç”Ÿçš„äº‹ä»¶ï¼ŒæŒ‡å®šçš„Goroutinesä½•æ—¶æ‰§è¡Œã€æ‰§è¡Œ äº†å¤šé•¿æ—¶é—´ã€ä»€ä¹ˆæ—¶å€™é™·å…¥äº†å µå¡ã€ä»€ä¹ˆæ—¶å€™è§£é™¤äº†å µå¡ã€GCå¦‚ä½•å½± å“å•ä¸ªGoroutineçš„æ‰§è¡Œã€STWä¸­æ–­èŠ±è´¹çš„æ—¶é—´æ˜¯å¦å¤ªé•¿ç­‰ ã€‚</p>
<ul>
<li>åç¨‹çš„åˆ›å»ºã€å¼€å§‹å’Œç»“æŸ</li>
<li>åç¨‹çš„å µå¡-ç³»ç»Ÿè°ƒç”¨ã€é€šé“ã€é”</li>
<li>ç½‘ç»œI/Oç›¸å…³äº‹ä»¶</li>
<li>ç³»ç»Ÿè°ƒç”¨äº‹ä»¶</li>
<li>åƒåœ¾å›æ”¶ç›¸å…³äº‹ä»¶</li>
</ul>
<pre><code class="hljs language-go"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;runtime/trace&quot;</span>

trace.<span class="hljs-title class_">Start</span>(f)

defer trace.<span class="hljs-title class_">Stop</span>()

<span class="hljs-comment">// or use net/pprof</span>
<span class="hljs-comment">// curl -o trace.out http.../debug/pprof/trace?second=20</span>

<span class="hljs-comment">// ç„¶åä½¿ç”¨go tool trace trace.outè¿›è¡Œåˆ†æ</span>
</code></pre><p>åœ¨traceçš„åˆå§‹é˜¶æ®µéœ€è¦é¦–å…ˆSTWï¼Œç„¶åè·å–åç¨‹çš„å¿«ç…§ã€çŠ¶æ€ã€æ ˆå¸§ä¿¡æ¯ï¼Œç„¶åå¼€å¯GCé‡æ–°å¯åŠ¨æ‰€æœ‰åç¨‹ã€‚goæºç ä¸­å¯¹äºå…³é”®äº‹ä»¶éƒ½åŠ äº†åˆ¤æ–­æ˜¯å¦å¼€å¯äº†traceï¼Œå¼€å¯åï¼Œè§¦å‘è¿™äº›äº‹ä»¶æ—¶éƒ½ä¼šå†™å…¥ã€‚</p>
<p>å…³é”®çš„äº‹ä»¶åŒ…æ‹¬åç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€åç¨‹å µå¡ã€ç½‘ç»œI/Oã€ç³»ç»Ÿ è°ƒç”¨ã€åƒåœ¾å›æ”¶ç­‰ï¼Œæ ¹æ®äº‹ä»¶çš„ä¸åŒï¼Œå¯èƒ½ä¿å­˜å’Œæ­¤äº‹ä»¶ç›¸å…³çš„ä¸åŒ æ•°é‡çš„å‚æ•°åŠæ ˆè¿½è¸ªæ•°æ®ã€‚æ¯ä¸ªé€»è¾‘å¤„ç†å™¨Péƒ½æœ‰ä¸€ä¸ªç¼“å­˜ (p.tracebuf)ï¼Œç”¨äºå­˜å‚¨å·²ç»è¢«åºåˆ—åŒ–ä¸ºå­—èŠ‚çš„äº‹ä»¶(Event) ã€‚æ¯ä¸ªpçš„tracebuféƒ½æœ‰é™åº¦ï¼Œè¶…è¿‡ä¹‹åä¼šè½¬ç§»åˆ°å…¨å±€é“¾è¡¨ã€‚</p>
<p>traceå·¥å…·ä¼šæ–°å¼€ä¸€ä¸ªåç¨‹ä¸“é—¨ç”¨äºè¯»å–å…¨å±€traceä¸Šçš„ä¿¡æ¯ï¼Œ æ­¤æ—¶å…¨å±€çš„äº‹ä»¶å¯¹è±¡å·²ç»æ˜¯åºåˆ—åŒ–ä¹‹åçš„å­—èŠ‚æ•°ç»„ï¼Œç›´æ¥æ·»åŠ åˆ°æ–‡ä»¶ ä¸­å³å¯ã€‚å¦å¤–ï¼Œè®¿é—®å…¨å±€traceç¼“å­˜éœ€è¦åŠ é”ï¼Œå½“æ²¡æœ‰å¯ä»¥è®¿é—®çš„å¯¹è±¡ æ—¶ï¼Œè¯»å–åç¨‹ä¼šé™·å…¥ä¼‘çœ çŠ¶æ€ ã€‚</p>
<p>å½“æŒ‡å®šçš„äº‹ä»¶åˆ°æœŸåç»“æŸtraceä»»åŠ¡ç¨‹åºå†æ¬¡è¿›å…¥STWï¼Œåˆ·æ–°é€»è¾‘å¤„ç†å™¨Pä¸Šçš„tracebufç¼“å­˜</p>
<h2>pyroscope</h2>
<p>åŸºäºpprofæ•°æ®çš„å¯è§†åŒ–å·¥å…·ï¼Œæä¾›ä¸ŠæŠ¥å’Œæ‹‰å–ä¸¤ç§æ¨¡å¼</p>
<p>æ”¯æŒå¤šç§è¯­è¨€</p>
<p>å¯ä»¥å°†å„ä¸ªæœåŠ¡çš„è¿è¡Œæ•°æ®é›†ä¸­èµ·æ¥ï¼Œæ›´åˆ©äºç®¡ç†</p>
<p>ä¸è¿‡åªèƒ½è·å–åˆ°å½“å‰æ—¶é—´ç‚¹çš„å†…å­˜åˆ†é…æƒ…å†µã€å½“å‰ä½¿ç”¨çš„å†…å­˜æƒ…å†µï¼Œä»¥åŠCPUè€—æ—¶ç­‰</p>
<p><del>å¦å¤–ï¼Œé™¤äº†æ— æ³•å¯¹åç¨‹æ•°ã€mutexç­‰è¿›è¡Œåˆ†æ</del>, åˆé”™æ€ªäº†ğŸ˜¹ï¼Œpyroscopeæ”¯æŒçš„åˆ†æç»´åº¦åŒ…æ‹¬(cpuã€inuse_objectsã€alloc_objectsã€inuse_spaceï¼Œalloc_space, goroutinesã€mutex_durationã€block_countã€block_durationï¼Œè¿™é‡Œé¢é™¤äº†pprofï¼Œåº”è¯¥è¿˜ç”¨äº†traceåŒ…é‡Œé¢çš„æ•°æ®)</p>
<p><del>ç»˜åˆ¶çš„æ—¶é—´æ›²çº¿æ²¡æœ‰å…·ä½“çš„æ•°å€¼ï¼Œä¹Ÿæ— æ³•æŸ¥çœ‹å…·ä½“æ—¶é—´ç‚¹ä¸‹çš„æ•°æ®æƒ…å†µ</del>(é”™æ€ªäº†ï¼Œæ—¶é—´åŒºé—´é€‰æ‹©å¯ä»¥ç”¨é¼ æ ‡æ»‘åŠ¨é€‰æ‹©ï¼Œæ— æ³•ç‚¹å‡»æŸä¸ªç‰¹å®šçš„æŸ±å½¢ç»“æ„)</p>
<h2>æ’æŸ¥CPUå ç”¨è¿‡é«˜</h2>
<p>topå‘½ä»¤ç¡®è®¤</p>
<p><code>go tool pprof http://localhost:6060/debug/pprof/profile</code></p>
<p>è¿›å…¥äº¤äº’ä½¿ç”¨topæŸ¥çœ‹CPUå ç”¨è¾ƒé«˜çš„è°ƒç”¨</p>
<p>top</p>
<p>ä½¿ç”¨list åå­— æŸ¥çœ‹è°ƒç”¨çš„å…·ä½“ä½ç½®</p>
<p>list Eat</p>
<p>å¦‚æœå®‰è£…äº†graphvizå·¥å…·ï¼Œä½¿ç”¨webå‘½ä»¤ä¹‹åèƒ½å¤Ÿåœ¨webç•Œé¢ä¸Šçœ‹åˆ°è°ƒç”¨é“¾è·¯å›¾</p>
<p>brew install graphviz</p>
<img src="/images/blogs/cpu-web.png" />

<p>ä¿®å¤é—®é¢˜ä»£ç ç»§ç»­åé¢çš„æ“ä½œ</p>
<h2>æ’æŸ¥å†…å­˜å ç”¨è¿‡é«˜</h2>
<p>ä¿®å¤ä»£ç ä¸­çš„æ­»å¾ªç¯ï¼Œå†æ¬¡ä½¿ç”¨topä¼šå‘ç°CPUå ç”¨ç‡ä¸‹æ¥äº†</p>
<p><code>go tool pprof http://localhost:6060/debug/pprof/heap</code></p>
<p>å†æ¬¡ä½¿ç”¨topã€listå®šä½åˆ°é—®é¢˜ä»£ç </p>
<pre><code class="hljs language-bash"><span class="hljs-attr">Total:</span> <span class="hljs-number">1.</span><span class="hljs-string">50GB</span>
<span class="hljs-string">ROUTINE</span> <span class="hljs-string">========================</span> <span class="hljs-string">github.com/wolfogre/go-pprof-practice/animal/muridae/mouse.(*Mouse).Steal</span> <span class="hljs-string">in</span> <span class="hljs-string">/Users/dengronghui/Documents/Apps/public/handbook/Golang/go-pprof-practice-master/animal/muridae/mouse/mouse.go</span>
    <span class="hljs-number">1.</span><span class="hljs-string">50GB</span>     <span class="hljs-number">1.</span><span class="hljs-string">50GB</span> <span class="hljs-string">(flat,</span> <span class="hljs-string">cum)</span> <span class="hljs-number">99.90</span><span class="hljs-string">%</span> <span class="hljs-string">of</span> <span class="hljs-string">Total</span>
         <span class="hljs-string">.</span>          <span class="hljs-string">.</span>     <span class="hljs-attr">45:</span>
         <span class="hljs-string">.</span>          <span class="hljs-string">.</span>     <span class="hljs-number">46</span><span class="hljs-string">:func</span> <span class="hljs-string">(m</span> <span class="hljs-string">*Mouse)</span> <span class="hljs-string">Steal()</span> {
         <span class="hljs-string">.</span>          <span class="hljs-string">.</span>     <span class="hljs-attr">47:</span>	<span class="hljs-string">log.Println(m.Name()</span>, <span class="hljs-string">&quot;steal&quot;</span><span class="hljs-string">)</span>
         <span class="hljs-string">.</span>          <span class="hljs-string">.</span>     <span class="hljs-attr">48:</span>	<span class="hljs-string">max</span> <span class="hljs-string">:=</span> <span class="hljs-string">constant.Gi</span>
         <span class="hljs-string">.</span>          <span class="hljs-string">.</span>     <span class="hljs-attr">49:</span>	<span class="hljs-string">for</span> <span class="hljs-string">len(m.buffer)*constant.Mi</span> <span class="hljs-string">&lt;</span> <span class="hljs-string">max</span> {
    <span class="hljs-attr">1.50GB     1.50GB     50:</span>		<span class="hljs-string">m.buffer</span> <span class="hljs-string">=</span> <span class="hljs-string">append(m.buffer</span>, [<span class="hljs-string">constant.Mi</span>]<span class="hljs-string">byte</span>{}<span class="hljs-string">)</span>
         <span class="hljs-string">.</span>          <span class="hljs-string">.</span>     <span class="hljs-attr">51:</span>	}
         <span class="hljs-string">.</span>          <span class="hljs-string">.</span>     <span class="hljs-number">52</span><span class="hljs-string">:</span>}
</code></pre><p>åŒæ ·å¯ä»¥ä½¿ç”¨webå¯è§†åŒ–å±•ç¤º</p>
<h2>æ’æŸ¥é¢‘ç¹å†…å­˜å›æ”¶</h2>
<p>è·å–ç¨‹åºè¿è¡Œæ—¶çš„GCæ—¥å¿—</p>
<pre><code class="hljs language-bash">gc 1 @0.003s 7%: 0.022+2.1+0.002 ms clock, 0.18+1.1/1.9/3.0+0.019 ms cpu, 4-&gt;4-&gt;3 MB, 5 MB goal, 8 P
gc 2 @0.018s 3%: 0.009+1.8+0.001 ms clock, 0.073+0.096/2.2/0.16+0.013 ms cpu, 7-&gt;7-&gt;6 MB, 8 MB goal, 8 P
gc 3 @0.089s 0%: 0.022+0.92+0.013 ms clock, 0.17+0.095/1.0/0.75+0.10 ms cpu, 16-&gt;16-&gt;14 MB, 17 MB goal, 8 P
gc 4 @0.489s 0%: 0.023+1.5+0.014 ms clock, 0.18+0/2.4/1.1+0.11 ms cpu, 29-&gt;29-&gt;15 MB, 30 MB goal, 8 P
gc 1 @0.003s 1%: 0.013+0.55+0.002 ms clock, 0.013+0.22/0.17/0+0.002 ms cpu, 16-&gt;16-&gt;0 MB, 17 MB goal, 1 P
gc 2 @3.020s 0%: 0.070+0.56+0.002 ms clock, 0.070+0.17/0.20/0+0.002 ms cpu, 16-&gt;16-&gt;0 MB, 17 MB goal, 1 P
gc 3 @6.027s 0%: 0.15+0.98+0.003 ms clock, 0.15+0.36/0.36/0+0.003 ms cpu, 16-&gt;16-&gt;0 MB, 17 MB goal, 1 P
gc 4 @9.034s 0%: 0.10+0.63+0.002 ms clock, 0.10+0.16/0.23/0+0.002 ms cpu, 16-&gt;16-&gt;0 MB, 17 MB goal, 1 P
gc 5 @12.040s 0%: 0.070+0.53+0.002 ms clock, 0.070+0.23/0.19/0+0.002 ms cpu, 16-&gt;16-&gt;0 MB, 17 MB goal, 1 P
gc 6 @15.047s 0%: 0.11+0.66+0.002 ms clock, 0.11+0.23/0.27/0+0.002 ms cpu, 16-&gt;16-&gt;0 MB, 17 MB goal, 1 P
</code></pre><img src="/images/blogs/gc_info.png" />

<p>æ¯æ¬¡gcéƒ½ä»16MBé‡Šæ”¾åˆ°0MBï¼Œè¯´æ˜ç¨‹åºåœ¨ä¸æ–­çš„å£°æ˜ç„¶åé‡Šæ”¾å†…å­˜</p>
<p>æ¥ä¸‹æ¥ä½¿ç”¨ pprof æ’æŸ¥æ—¶ï¼Œæˆ‘ä»¬åœ¨ä¹çš„ä¸æ˜¯ä»€ä¹ˆåœ°æ–¹åœ¨å ç”¨å¤§é‡å†…å­˜ï¼Œè€Œæ˜¯ä»€ä¹ˆåœ°æ–¹åœ¨ä¸åœåœ°ç”³è¯·å†…</p>
<p><code>go tool pprof http://localhost:6060/debug/pprof/allocs</code></p>
<h2>æ’æŸ¥åç¨‹æ³„æ¼</h2>
<p><code>go tool pprof http://localhost:6060/debug/pprof/goroutine</code></p>
<p>åŒæ ·ä½¿ç”¨topã€listã€webå³å¯å®šä½åˆ°</p>
<h2>æ’æŸ¥é”çš„äº‰ç”¨</h2>
<p><code>go tool pprof http://localhost:6060/debug/pprof/mutex</code></p>
</div></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"\u003ch1\u003efmt\u003c/h1\u003e\n\u003cp\u003eä»£ç é£æ ¼æ ¼å¼åŒ– gofmtã€go fmtæ ‡å‡†å·¥å…·\u003c/p\u003e\n\u003ch1\u003evet\u003c/h1\u003e\n\u003cp\u003eæ•æ‰å¯èƒ½å‡ºç°çš„é”™è¯¯ æ ‡å‡†å·¥å…· ä¸€èˆ¬æ¥è¯´ç¼–è¾‘å™¨ä¾‹å¦‚vscodeéƒ½å·²ç»é›†æˆäº†è¿™äº›åŠŸèƒ½ï¼Œæ‰€ä»¥ä¸éœ€è¦å•ç‹¬æ£€æµ‹\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ego vet -all\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003evetä¸€èˆ¬æ˜¯æ£€æŸ¥\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-go\"\u003epackage main \n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;fmt\u0026quot;\u003c/span\u003e \n\n\u003cspan class=\"hljs-comment\"\u003e// Prints out \u0026quot;Super Mario 3\u0026quot; \u003c/span\u003e\nfunc \u003cspan class=\"hljs-title function_\"\u003emain\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) { \n    game_version :=\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \n    fmt.\u003cspan class=\"hljs-title class_\"\u003ePrintf\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Super Mario %s\\n\u0026quot;\u003c/span\u003e,game_version) \n    \u003cspan class=\"hljs-comment\"\u003e// ./main.go:6:2: Printf format %s has arg 3 of wrong type int\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch1\u003elint\u003c/h1\u003e\n\u003cp\u003eä»£ç é™æ€æ£€æŸ¥\u003c/p\u003e\n\u003cp\u003egolintã€golangci-lint\u003c/p\u003e\n\u003ch2\u003egolangci-lint\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒ: \u003ca href=\"https://golangci-lint.run/usage/configuration/\"\u003ehttps://golangci-lint.run/usage/configuration/\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003egolangci-lint run\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e.golangci.yaml\u003c/code\u003eé…ç½®linté€‰é¡¹\u003c/p\u003e\n\u003ch3\u003eé…ç½®é¡¹\u003c/h3\u003e\n\u003cp\u003erun\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003erun:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003econcurrency:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003etimeout:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e5m\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eissues-exit-code:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003etests:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ebuild-tags:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emytag\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eskip-dirs:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esrc/external_libs\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eautogenerated_by_my_lib\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eskip-dirs-use-default:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eskip-files:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;.*\\\\.my\\\\.go$\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elib/bad.go\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003emodules-download-mode:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# readonly|vendor|mod\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eallow-parallel-runners:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# If false (default) - golangci-lint acquires file lock on start.\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ego:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;1.18\u0026#x27;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eoutput\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003eoutput:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eformat:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ejson\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# colored-line-number|line-number|json|tab|checkstyle|code-climate|junit-xml|github-actions\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eprint-issued-lines:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eprint-linter-name:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003euniq-by-line:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003epath-prefix:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003esort-results:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003elinters\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003elinters:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edisable-all:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# Default: false\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Enable specific linter\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# https://golangci-lint.run/usage/linters/#enabled-by-default\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eenable:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003easasalint\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003easciicheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ebidichk\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ebodyclose\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econtainedctx\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econtextcheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ecyclop\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edeadcode\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edecorder\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edepguard\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edogsled\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edupl\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edupword\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edurationcheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eerrcheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eerrchkjson\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eerrname\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eerrorlint\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexecinquery\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexhaustive\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexhaustivestruct\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexhaustruct\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eexportloopref\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eforbidigo\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eforcetypeassert\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003efunlen\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egci\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egochecknoglobals\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egochecknoinits\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egocognit\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egoconst\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egocritic\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egocyclo\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egodot\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egodox\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egoerr113\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egofmt\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egofumpt\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egoheader\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egoimports\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egolint\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egomnd\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egomoddirectives\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egomodguard\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egoprintffuncname\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egosec\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egosimple\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egovet\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egrouper\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eifshort\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eimportas\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eineffassign\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003einterfacebloat\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003einterfacer\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eireturn\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elll\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eloggercheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emaintidx\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emakezero\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emaligned\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emisspell\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enakedret\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enestif\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enilerr\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enilnil\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enlreturn\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enoctx\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enolintlint\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enonamedreturns\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enosnakecase\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003enosprintfhostport\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eparalleltest\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eprealloc\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epredeclared\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epromlinter\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ereassign\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erevive\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003erowserrcheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003escopelint\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esqlclosecheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estaticcheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estructcheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estylecheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etagliatelle\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etenv\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etestableexamples\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etestpackage\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ethelper\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etparallel\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etypecheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eunconvert\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eunparam\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eunused\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eusestdlibvars\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003evarcheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003evarnamelen\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ewastedassign\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ewhitespace\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ewrapcheck\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ewsl\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eenable-all:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e# Default: false\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edisable:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# åŒenableé¡¹ä¸€æ ·\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Enable presets.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# https://golangci-lint.run/usage/linters\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003epresets:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ebugs\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ecomment\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ecomplexity\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eerror\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eformat\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eimport\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emetalinter\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emodule\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eperformance\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003esql\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estyle\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etest\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eunused\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Run only fast linters from enabled linters set (first run won\u0026#x27;t be fast)\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Default: false\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003efast:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eissues\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003eissues:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eexclude:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eabcdef\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Excluding configuration per-path, per-linter, per-text and per-source\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eexclude-rules:\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# Exclude some linters from running on tests files.\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003epath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e_test\\.go\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003elinters:\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egocyclo\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eerrcheck\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edupl\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egosec\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# Exclude known linters from partially hard-vendored code,\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# which is impossible to exclude via `nolint` comments.\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# `/` will be replaced by current OS file path separator to properly work on Windows.\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003epath:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003einternal/hmac/\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003etext:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;weak cryptographic primitive\u0026quot;\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003elinters:\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egosec\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# Exclude some `staticcheck` messages.\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003elinters:\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003estaticcheck\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003etext:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;SA9003:\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# Exclude `lll` issues for long lines with `go:generate`.\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003elinters:\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elll\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003esource:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;^//go:generate \u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eexclude-use-default:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003eexclude-case-sensitive:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# The list of ids of default excludes to include or disable.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# https://golangci-lint.run/usage/false-positives/#default-exclusions\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Default: []\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003einclude:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0001\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0002\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0003\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0004\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0005\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0006\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0007\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0008\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0009\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0010\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0011\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0012\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0013\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0014\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eEXC0015\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Maximum issues count per one linter.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Set to 0 to disable.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Default: 50\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003emax-issues-per-linter:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Maximum count of issues with the same text.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Set to 0 to disable.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Default: 3\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003emax-same-issues:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Show only new issues: if there are unstaged changes or untracked files,\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# only those changes are analyzed, else only changes in HEAD~ are analyzed.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# It\u0026#x27;s a super-useful option for integration of golangci-lint into existing large codebase.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# It\u0026#x27;s not practical to fix all existing issues at the moment of integration:\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# much better don\u0026#x27;t allow issues in new code.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e#\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Default: false.\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003enew:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Show only new issues created after git revision `REV`.\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003enew-from-rev:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eHEAD\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Show only new issues created in git patch with set file path.\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003enew-from-patch:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epath/to/patch/file\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e# Fix found issues (if it\u0026#x27;s supported by the linter).\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003efix:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eseverity\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-yaml\"\u003e\u003cspan class=\"hljs-attr\"\u003eseverity:\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003edefault-severity:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eerror\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003ecase-sensitive:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003erules:\u003c/span\u003e\n    \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003elinters:\u003c/span\u003e\n        \u003cspan class=\"hljs-bullet\"\u003e-\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003edupl\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003eseverity:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003einfo\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003ch1\u003eå•å…ƒæµ‹è¯•\u003c/h1\u003e\n\u003cp\u003eåœ¨å•å…ƒæµ‹è¯•é¢†åŸŸï¼Œå…³äºå¦‚ä½•æ›¿æ¢æ‰å¤–éƒ¨ä¾èµ–ï¼Œä¸»è¦æœ‰ä¸¤ç§æŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ mock å’Œ stubï¼šmock é€šè¿‡æ¥å£å¯ä»¥åŠ¨æ€è°ƒæ•´å¤–éƒ¨ä¾èµ–çš„è¿”å›å€¼ï¼Œè€Œ stub åªèƒ½åœ¨è¿è¡Œæ—¶é™æ€è°ƒæ•´å¤–éƒ¨ä¾èµ–çš„è¿”å›å€¼\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eä½¿ç”¨è¿™äº›éƒ½æ˜¯å°±æ˜¯ä¸ºäº†æ›¿æ¢å¤–éƒ¨ä¾èµ–æ—¶å€™ä½¿ç”¨çš„ï¼Œåªæ˜¯ä¸ºäº†å•å…ƒæµ‹è¯•è¦†ç›–ç‡å˜é«˜ä¸€ç‚¹ğŸ˜¹\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003egithub.com/stretchr/testify/\u003cspan class=\"hljs-keyword\"\u003eassert\u003c/span\u003e\n\ngithub.com/smartystreets/goconvey/convey\n\ngithub.com/golang/mock/gomock\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ccode\u003ego install github.com/golang/mock/mockgen@latest\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003egotest\u003c/h2\u003e\n\u003cp\u003eå®˜æ–¹å†…ç½®çš„å·¥å…·\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæ€§èƒ½æµ‹è¯•\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003ego test -bench\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eå®šä¹‰Benchå¼€å¤´çš„æµ‹è¯•å‡½æ•°\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eè¦†ç›–ç‡\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003ego test -cover\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eç«æ€æ£€æŸ¥\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003ego test -race\u003c/code\u003eç”¨äºæ£€æŸ¥ä»£ç ä¸­æ˜¯å¦å­˜åœ¨å¹¶å‘å®‰å…¨é—®é¢˜\u003c/p\u003e\n\u003ch2\u003etestify\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eassert\u003c/li\u003e\n\u003cli\u003erequire(ä¸assertä¸€æ ·ï¼Œä¸è¿‡å¼‚å¸¸ä¼šé€€å‡º)\u003c/li\u003e\n\u003cli\u003emock\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eåœ¨è¦ç¼–å†™ä¸€ä¸ªä»ä¸€ä¸ªç«™ç‚¹æ‹‰å–ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯çš„ç¨‹åºï¼Œæ‹‰å–å®Œæˆä¹‹åç¨‹åºæ˜¾ç¤ºå’Œåˆ†æã€‚å¦‚æœæ¯æ¬¡éƒ½å»è®¿é—®ç½‘ç»œä¼šå¸¦æ¥æå¤§çš„ä¸ç¡®å®šæ€§ï¼Œç”šè‡³æ¯æ¬¡è¿”å›ä¸åŒçš„åˆ—è¡¨ï¼Œè¿™å°±ç»™æµ‹è¯•å¸¦æ¥äº†æå¤§çš„å›°éš¾ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Mock æŠ€æœ¯ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eä½†æ˜¯é—®é¢˜åœ¨äºå¦‚æœç›´æ¥ä½¿ç”¨æ–°çš„æ¥å£è¿›è¡Œäº†æ›¿æ¢ï¼Œé‚£ä¹ˆä¼šå¯¼è‡´æœ‰äº›ä»£ç åˆ†æ”¯è¿›å…¥ä¸åˆ°ï¼Œè¦†ç›–ç‡é™ä½\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esuite\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003egomock\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ego mock\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ego get -u github.com/golang/mock/gomock go get -u github.com/golang/mock/mockgen\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eè¦ä½¿ç”¨gomockçš„ä¸€ä¸ªå‰ææ˜¯æ¨¡å—ä¹‹é—´åŠ¡å¿…é€šè¿‡æ¥å£è¿›è¡Œä¾èµ–ï¼Œè€Œä¸æ˜¯ä¾èµ–å…·ä½“å®ç°ï¼Œå¦åˆ™mockä¼šéå¸¸å›°éš¾ã€‚è¿™ä¸ªå·¥å…·ç›®å‰ä¸šç•Œç”¨çš„å¹¶ä¸å¤šï¼Œä¸»è¦æ˜¯å±€é™æ€§å¤ªå¤§\u003c/p\u003e\n\u003cp\u003eåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå½“éœ€è¦è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼Œå¾€å¾€ä¼šæœ‰å¾ˆå¤šçš„ä¾èµ–é¡¹ï¼Œæœ‰äº›ä¾èµ–å¯èƒ½è¿˜æ²¡æœ‰åŠæ³•ç›´æ¥è¿›è¡Œåˆ›å»ºï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥ï¼Œæ–‡ä»¶ I/O ç­‰ã€‚æ­¤æ—¶é€šè¿‡ä½¿ç”¨ go mock å¯ä»¥æ¨¡æ‹Ÿä¾èµ–é¡¹ï¼Œç®€åŒ–æµ‹è¯•ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eæ¡©\u003c/strong\u003eï¼Œæˆ–ç§°æ¡©ä»£ç ï¼Œæ˜¯æŒ‡ç”¨æ¥ä»£æ›¿å…³è”ä»£ç æˆ–è€…æœªå®ç°ä»£ç çš„ä»£ç ã€‚å¦‚æœå‡½æ•° B ç”¨ B1 æ¥ä»£æ›¿ï¼Œé‚£ä¹ˆï¼ŒB ç§°ä¸ºåŸå‡½æ•°ï¼ŒB1 ç§°ä¸ºæ¡©å‡½æ•°ã€‚æ‰“æ¡©å°±æ˜¯ç¼–å†™æˆ–ç”Ÿæˆæ¡©ä»£ç ã€‚\u003c/p\u003e\n\u003ch2\u003egostub\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ego get github.com/prashantv/gostub\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eä¸ºä¸€ä¸ªå…¨å±€å˜é‡æ‰“æ¡©\u003c/li\u003e\n\u003cli\u003eä¸ºä¸€ä¸ªå‡½æ•°æ‰“æ¡©\u003c/li\u003e\n\u003cli\u003eä¸ºä¸€ä¸ªè¿‡ç¨‹æ‰“æ¡©\u003c/li\u003e\n\u003cli\u003eç”±ä»»æ„ç›¸åŒæˆ–ä¸åŒçš„åŸºæœ¬åœºæ™¯ç»„åˆè€Œæˆ\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-go\"\u003efunc \u003cspan class=\"hljs-title class_\"\u003eTestStubMethod\u003c/span\u003e(t *testing.\u003cspan class=\"hljs-property\"\u003eT\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e printStr = \u003cspan class=\"hljs-title function_\"\u003efunc\u003c/span\u003e(val string) string {\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e val\n    }\n\n    \u003cspan class=\"hljs-comment\"\u003e// é’ˆå¯¹æœ‰å‚æ•°æœ‰è¿”å›å€¼çš„\u003c/span\u003e\n    stubs := gostub.\u003cspan class=\"hljs-title class_\"\u003eStub\u003c/span\u003e(\u0026amp;printStr, \u003cspan class=\"hljs-title function_\"\u003efunc\u003c/span\u003e(val string) string {\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;hello,\u0026quot;\u003c/span\u003e + val\n    })\n    defer stubs.\u003cspan class=\"hljs-title class_\"\u003eReset\u003c/span\u003e()\n    fmt.\u003cspan class=\"hljs-title class_\"\u003ePrintln\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;After stub: \u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003eprintStr\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;hhhhh\u0026quot;\u003c/span\u003e))\n\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e printStr2 = \u003cspan class=\"hljs-title function_\"\u003efunc\u003c/span\u003e(val string) string {\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e val\n    }\n    \u003cspan class=\"hljs-comment\"\u003e// StubFunc ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°å˜é‡çš„æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘çš„å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°å˜é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•° mock çš„è¿”å›å€¼\u003c/span\u003e\n    stubs2 := gostub.\u003cspan class=\"hljs-title class_\"\u003eStubFunc\u003c/span\u003e(\u0026amp;printStr2, \u003cspan class=\"hljs-string\"\u003e\u0026quot;ddddd,ä¸‡ç”Ÿä¸–ä»£\u0026quot;\u003c/span\u003e)\n    defer stubs2.\u003cspan class=\"hljs-title class_\"\u003eReset\u003c/span\u003e()\n    fmt.\u003cspan class=\"hljs-title class_\"\u003ePrintln\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;After stub:\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-title function_\"\u003eprintStr2\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;lalala\u0026quot;\u003c/span\u003e))\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003egomonkey\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003egithub.com/agiledragon/gomonkey/v2\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e1ã€å®ƒè¿åäº†å¼€é—­åŸåˆ™ã€‚\n2ã€è¿è¡Œæ—¶å¿…é¡»å…³é—­å†…è¿ã€Œgo test -gcflags=all=-lã€ã€‚\n3ã€è¿è¡Œæ—¶éœ€è¦å¾ˆé«˜çš„æƒé™ï¼Œå¹¶ä¸”ä¸åŒçš„ç¡¬ä»¶éœ€è¦ä¸åŒçš„é»‘ç§‘æŠ€å®ç°\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eç›´æ¥åœ¨æ–¹æ³•çº§åˆ«ä¸Šè¿›è¡Œ mock\u003cbr\u003eï¼ˆåœ¨è¿è¡Œæ—¶é€šè¿‡æ±‡ç¼–è¯­å¥é‡å†™å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå°†å¾…æ‰“æ¡©å‡½æ•°æˆ–æ–¹æ³•çš„å®ç°è·³è½¬åˆ°æ¡©å®ç°ï¼‰\u003cbr\u003eåœ¨ç¼–è¯‘é˜¶æ®µç›´æ¥æ›¿æ¢æ‰çœŸçš„å‡½æ•°ä»£ç éƒ¨åˆ†  \u003c/li\u003e\n\u003cli\u003eéçº¿ç¨‹å®‰å…¨ï¼Œè¯·å‹¿ç”¨äºå¹¶å‘æµ‹è¯•\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eå¹¶ä¸”å¿…é¡»åŠ ä¸Š\u003ccode\u003e\u0026quot;-gcflags=all=-l\u0026quot;\u003c/code\u003e, é¿å…å†…è”ä¼˜åŒ–(çŸ­å‡½æ•°ç›´æ¥è¢«åˆå¹¶ä¸ä¼šå•ç‹¬ä½œä¸ºä¸€ä¸ªå‡½æ•°)å¯¼è‡´æµ‹è¯•å¤±è´¥\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-go\"\u003efunc DoSomething(name string, args ...string) (string, error) {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e, errors.New(\u003cspan class=\"hljs-string\"\u003e\u0026quot;TODO\u0026quot;\u003c/span\u003e)\n}\n\nfunc TestExec(t *testing.T) {\n    patches := gomonkey.NewPatches()\n    defer patches.Reset()\n    outputExpect := \u003cspan class=\"hljs-string\"\u003e\u0026quot;xxx-vethName100-yyy\u0026quot;\u003c/span\u003e\n    guard := patches.ApplyFunc(DoSomething, func(_ string, _ ...string) (string, error) {\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e outputExpect, nil\n    })\n    defer guard.Reset()\n    output, err := DoSomething(\u003cspan class=\"hljs-string\"\u003e\u0026quot;asd\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;2\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;3\u0026quot;\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eassert\u003c/span\u003e.Nil(t, err)\n    \u003cspan class=\"hljs-keyword\"\u003eassert\u003c/span\u003e.Equal(t, outputExpect, output)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003ehttpæµ‹è¯•\u003c/h2\u003e\n\u003cp\u003eåœ¨ web é¡¹ç›®ä¸­ï¼Œå¤§å¤šæ¥å£æ˜¯å¤„ç† http è¯·æ±‚ï¼ˆpostã€get ä¹‹ç±»çš„ï¼‰ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œæ˜¯è®¿é—®ä¸åˆ°å®ƒå‘èµ·çš„ get è¯·æ±‚çš„ url çš„ï¼Œæ­¤æ—¶å°±å¯ä»¥æ¨¡æ‹Ÿ http è¯·æ±‚æ¥å†™æµ‹è¯•ã€‚å¯ä»¥åˆ©ç”¨å®˜æ–¹è‡ªå¸¦çš„ http åŒ…æ¥è¿›è¡Œæ¨¡æ‹Ÿè¯·æ±‚ã€‚\u003c/p\u003e\n\u003ch2\u003esqlæµ‹è¯•\u003c/h2\u003e\n\u003cp\u003eæ¨¡æ‹Ÿä»»ä½•å®ç°äº† sql/driver æ¥å£çš„ db é©±åŠ¨ï¼Œæ— éœ€å…³æ³¨ db è¿æ¥ã€‚\u003c/p\u003e\n\u003ch1\u003eæ€§èƒ½è°ƒä¼˜\u003c/h1\u003e\n\u003cp\u003eä½¿ç”¨goå†…ç½®çš„å·¥å…·pprofå³å¯åˆ†æç¨‹åºè¿è¡ŒçŠ¶æ€çš„æ•´ä½“æƒ…å†µ\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eallocs\u003c/th\u003e\n\u003cth\u003eå†…å­˜åˆ†é…æƒ…å†µçš„é‡‡æ ·ä¿¡æ¯\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\u003ctr\u003e\n\u003ctd\u003eblocks\u003c/td\u003e\n\u003ctd\u003eé˜»å¡æ“ä½œæƒ…å†µçš„é‡‡æ ·ä¿¡æ¯\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecmdline\u003c/td\u003e\n\u003ctd\u003eç¨‹åºå¯åŠ¨å‘½ä»¤å‚æ•°\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003egoroutine\u003c/td\u003e\n\u003ctd\u003eæ‰€æœ‰åç¨‹çš„å †æ ˆä¿¡æ¯\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eheap\u003c/td\u003e\n\u003ctd\u003eå †ä¸Šçš„å†…å­˜åˆ†é…æƒ…å†µ\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003emutex\u003c/td\u003e\n\u003ctd\u003eé”ç«äº‰æƒ…å†µçš„é‡‡æ ·ä¿¡æ¯\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eprofile\u003c/td\u003e\n\u003ctd\u003ecpuå ç”¨æƒ…å†µçš„é‡‡æ ·ä¿¡æ¯\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ethreadcreate\u003c/td\u003e\n\u003ctd\u003eç³»ç»Ÿçº¿ç¨‹åˆ›å»ºæƒ…å†µçš„é‡‡æ ·ä¿¡æ¯\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etrace\u003c/td\u003e\n\u003ctd\u003eç¨‹åºè¿è¡Œè·Ÿè¸ªä¿¡æ¯\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n\u003cul\u003e\n\u003cli\u003eruntim/pprof: æ‰‹åŠ¨è°ƒç”¨ï¼Œä¸€èˆ¬åœ¨å‡½æ•°å…¥å£ä¸­\u003c/li\u003e\n\u003cli\u003enet/http/pprof: ç”¨äºwebç³»ç»Ÿä¸­ï¼Œä¸è¿‡åªæ˜¯å¯¹runtime/pprofçš„ç®€å•å°è£…\u003c/li\u003e\n\u003cli\u003egin-contribæä¾›äº†å¯¹net/http/pprofçš„å°è£…ï¼Œèƒ½å¤Ÿåœ¨ginä¸­ä½¿ç”¨\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œprofileæ‰€æ˜¾ç¤ºçš„æ—¶é—´æ˜æ˜¾å°äºæ¥å£è°ƒç”¨çš„æ—¶é—´ï¼Œæ˜¯å› ä¸ºprofileåªèƒ½å¤Ÿåˆ†æcpuçš„è€—æ—¶ï¼Œæ— æ³•è®¡ç®—ioæƒ…å†µ(å› ä¸ºioä¸ä¼šå ç”¨cpu)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# ä¸‹è½½cpu profileï¼Œé»˜è®¤ä»å½“å‰å¼€å§‹æ”¶é›†30sçš„cpuä½¿ç”¨æƒ…å†µï¼Œéœ€è¦ç­‰å¾…30s\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003ego\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etool\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epprof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttp://localhost:6060/debug/pprof/profile\u003c/span\u003e   \u003cspan class=\"hljs-comment\"\u003e# 30-second CPU profile\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003ego\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etool\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epprof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttp://localhost:6060/debug/pprof/profile?seconds=120\u003c/span\u003e     \u003cspan class=\"hljs-comment\"\u003e# wait 120s\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# ä¸‹è½½heap profile\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003ego\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etool\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epprof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttp://localhost:6060/debug/pprof/heap\u003c/span\u003e      \u003cspan class=\"hljs-comment\"\u003e# heap profile\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# ä¸‹è½½goroutine profile\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003ego\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etool\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epprof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttp://localhost:6060/debug/pprof/goroutine\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# goroutine profile\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# ä¸‹è½½block profile\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003ego\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etool\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epprof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttp://localhost:6060/debug/pprof/block\u003c/span\u003e     \u003cspan class=\"hljs-comment\"\u003e# goroutine blocking profile\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e# ä¸‹è½½mutex profile\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003ego\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003etool\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003epprof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ehttp://localhost:6060/debug/pprof/mutex\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003etrace\u003c/h2\u003e\n\u003cp\u003etraceå·¥å…·ï¼Œç”¨äºæŸ¥çœ‹æ•´ä¸ªå‘¨æœŸå†…å‘ç”Ÿçš„äº‹ä»¶ï¼ŒæŒ‡å®šçš„Goroutinesä½•æ—¶æ‰§è¡Œã€æ‰§è¡Œ äº†å¤šé•¿æ—¶é—´ã€ä»€ä¹ˆæ—¶å€™é™·å…¥äº†å µå¡ã€ä»€ä¹ˆæ—¶å€™è§£é™¤äº†å µå¡ã€GCå¦‚ä½•å½± å“å•ä¸ªGoroutineçš„æ‰§è¡Œã€STWä¸­æ–­èŠ±è´¹çš„æ—¶é—´æ˜¯å¦å¤ªé•¿ç­‰ ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eåç¨‹çš„åˆ›å»ºã€å¼€å§‹å’Œç»“æŸ\u003c/li\u003e\n\u003cli\u003eåç¨‹çš„å µå¡-ç³»ç»Ÿè°ƒç”¨ã€é€šé“ã€é”\u003c/li\u003e\n\u003cli\u003eç½‘ç»œI/Oç›¸å…³äº‹ä»¶\u003c/li\u003e\n\u003cli\u003eç³»ç»Ÿè°ƒç”¨äº‹ä»¶\u003c/li\u003e\n\u003cli\u003eåƒåœ¾å›æ”¶ç›¸å…³äº‹ä»¶\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-go\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;runtime/trace\u0026quot;\u003c/span\u003e\n\ntrace.\u003cspan class=\"hljs-title class_\"\u003eStart\u003c/span\u003e(f)\n\ndefer trace.\u003cspan class=\"hljs-title class_\"\u003eStop\u003c/span\u003e()\n\n\u003cspan class=\"hljs-comment\"\u003e// or use net/pprof\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// curl -o trace.out http.../debug/pprof/trace?second=20\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// ç„¶åä½¿ç”¨go tool trace trace.outè¿›è¡Œåˆ†æ\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eåœ¨traceçš„åˆå§‹é˜¶æ®µéœ€è¦é¦–å…ˆSTWï¼Œç„¶åè·å–åç¨‹çš„å¿«ç…§ã€çŠ¶æ€ã€æ ˆå¸§ä¿¡æ¯ï¼Œç„¶åå¼€å¯GCé‡æ–°å¯åŠ¨æ‰€æœ‰åç¨‹ã€‚goæºç ä¸­å¯¹äºå…³é”®äº‹ä»¶éƒ½åŠ äº†åˆ¤æ–­æ˜¯å¦å¼€å¯äº†traceï¼Œå¼€å¯åï¼Œè§¦å‘è¿™äº›äº‹ä»¶æ—¶éƒ½ä¼šå†™å…¥ã€‚\u003c/p\u003e\n\u003cp\u003eå…³é”®çš„äº‹ä»¶åŒ…æ‹¬åç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€åç¨‹å µå¡ã€ç½‘ç»œI/Oã€ç³»ç»Ÿ è°ƒç”¨ã€åƒåœ¾å›æ”¶ç­‰ï¼Œæ ¹æ®äº‹ä»¶çš„ä¸åŒï¼Œå¯èƒ½ä¿å­˜å’Œæ­¤äº‹ä»¶ç›¸å…³çš„ä¸åŒ æ•°é‡çš„å‚æ•°åŠæ ˆè¿½è¸ªæ•°æ®ã€‚æ¯ä¸ªé€»è¾‘å¤„ç†å™¨Péƒ½æœ‰ä¸€ä¸ªç¼“å­˜ (p.tracebuf)ï¼Œç”¨äºå­˜å‚¨å·²ç»è¢«åºåˆ—åŒ–ä¸ºå­—èŠ‚çš„äº‹ä»¶(Event) ã€‚æ¯ä¸ªpçš„tracebuféƒ½æœ‰é™åº¦ï¼Œè¶…è¿‡ä¹‹åä¼šè½¬ç§»åˆ°å…¨å±€é“¾è¡¨ã€‚\u003c/p\u003e\n\u003cp\u003etraceå·¥å…·ä¼šæ–°å¼€ä¸€ä¸ªåç¨‹ä¸“é—¨ç”¨äºè¯»å–å…¨å±€traceä¸Šçš„ä¿¡æ¯ï¼Œ æ­¤æ—¶å…¨å±€çš„äº‹ä»¶å¯¹è±¡å·²ç»æ˜¯åºåˆ—åŒ–ä¹‹åçš„å­—èŠ‚æ•°ç»„ï¼Œç›´æ¥æ·»åŠ åˆ°æ–‡ä»¶ ä¸­å³å¯ã€‚å¦å¤–ï¼Œè®¿é—®å…¨å±€traceç¼“å­˜éœ€è¦åŠ é”ï¼Œå½“æ²¡æœ‰å¯ä»¥è®¿é—®çš„å¯¹è±¡ æ—¶ï¼Œè¯»å–åç¨‹ä¼šé™·å…¥ä¼‘çœ çŠ¶æ€ ã€‚\u003c/p\u003e\n\u003cp\u003eå½“æŒ‡å®šçš„äº‹ä»¶åˆ°æœŸåç»“æŸtraceä»»åŠ¡ç¨‹åºå†æ¬¡è¿›å…¥STWï¼Œåˆ·æ–°é€»è¾‘å¤„ç†å™¨Pä¸Šçš„tracebufç¼“å­˜\u003c/p\u003e\n\u003ch2\u003epyroscope\u003c/h2\u003e\n\u003cp\u003eåŸºäºpprofæ•°æ®çš„å¯è§†åŒ–å·¥å…·ï¼Œæä¾›ä¸ŠæŠ¥å’Œæ‹‰å–ä¸¤ç§æ¨¡å¼\u003c/p\u003e\n\u003cp\u003eæ”¯æŒå¤šç§è¯­è¨€\u003c/p\u003e\n\u003cp\u003eå¯ä»¥å°†å„ä¸ªæœåŠ¡çš„è¿è¡Œæ•°æ®é›†ä¸­èµ·æ¥ï¼Œæ›´åˆ©äºç®¡ç†\u003c/p\u003e\n\u003cp\u003eä¸è¿‡åªèƒ½è·å–åˆ°å½“å‰æ—¶é—´ç‚¹çš„å†…å­˜åˆ†é…æƒ…å†µã€å½“å‰ä½¿ç”¨çš„å†…å­˜æƒ…å†µï¼Œä»¥åŠCPUè€—æ—¶ç­‰\u003c/p\u003e\n\u003cp\u003e\u003cdel\u003eå¦å¤–ï¼Œé™¤äº†æ— æ³•å¯¹åç¨‹æ•°ã€mutexç­‰è¿›è¡Œåˆ†æ\u003c/del\u003e, åˆé”™æ€ªäº†ğŸ˜¹ï¼Œpyroscopeæ”¯æŒçš„åˆ†æç»´åº¦åŒ…æ‹¬(cpuã€inuse_objectsã€alloc_objectsã€inuse_spaceï¼Œalloc_space, goroutinesã€mutex_durationã€block_countã€block_durationï¼Œè¿™é‡Œé¢é™¤äº†pprofï¼Œåº”è¯¥è¿˜ç”¨äº†traceåŒ…é‡Œé¢çš„æ•°æ®)\u003c/p\u003e\n\u003cp\u003e\u003cdel\u003eç»˜åˆ¶çš„æ—¶é—´æ›²çº¿æ²¡æœ‰å…·ä½“çš„æ•°å€¼ï¼Œä¹Ÿæ— æ³•æŸ¥çœ‹å…·ä½“æ—¶é—´ç‚¹ä¸‹çš„æ•°æ®æƒ…å†µ\u003c/del\u003e(é”™æ€ªäº†ï¼Œæ—¶é—´åŒºé—´é€‰æ‹©å¯ä»¥ç”¨é¼ æ ‡æ»‘åŠ¨é€‰æ‹©ï¼Œæ— æ³•ç‚¹å‡»æŸä¸ªç‰¹å®šçš„æŸ±å½¢ç»“æ„)\u003c/p\u003e\n\u003ch2\u003eæ’æŸ¥CPUå ç”¨è¿‡é«˜\u003c/h2\u003e\n\u003cp\u003etopå‘½ä»¤ç¡®è®¤\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ego tool pprof http://localhost:6060/debug/pprof/profile\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eè¿›å…¥äº¤äº’ä½¿ç”¨topæŸ¥çœ‹CPUå ç”¨è¾ƒé«˜çš„è°ƒç”¨\u003c/p\u003e\n\u003cp\u003etop\u003c/p\u003e\n\u003cp\u003eä½¿ç”¨list åå­— æŸ¥çœ‹è°ƒç”¨çš„å…·ä½“ä½ç½®\u003c/p\u003e\n\u003cp\u003elist Eat\u003c/p\u003e\n\u003cp\u003eå¦‚æœå®‰è£…äº†graphvizå·¥å…·ï¼Œä½¿ç”¨webå‘½ä»¤ä¹‹åèƒ½å¤Ÿåœ¨webç•Œé¢ä¸Šçœ‹åˆ°è°ƒç”¨é“¾è·¯å›¾\u003c/p\u003e\n\u003cp\u003ebrew install graphviz\u003c/p\u003e\n\u003cimg src=\"/images/blogs/cpu-web.png\" /\u003e\n\n\u003cp\u003eä¿®å¤é—®é¢˜ä»£ç ç»§ç»­åé¢çš„æ“ä½œ\u003c/p\u003e\n\u003ch2\u003eæ’æŸ¥å†…å­˜å ç”¨è¿‡é«˜\u003c/h2\u003e\n\u003cp\u003eä¿®å¤ä»£ç ä¸­çš„æ­»å¾ªç¯ï¼Œå†æ¬¡ä½¿ç”¨topä¼šå‘ç°CPUå ç”¨ç‡ä¸‹æ¥äº†\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ego tool pprof http://localhost:6060/debug/pprof/heap\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eå†æ¬¡ä½¿ç”¨topã€listå®šä½åˆ°é—®é¢˜ä»£ç \u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-attr\"\u003eTotal:\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e50GB\u003c/span\u003e\n\u003cspan class=\"hljs-string\"\u003eROUTINE\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e========================\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003egithub.com/wolfogre/go-pprof-practice/animal/muridae/mouse.(*Mouse).Steal\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e/Users/dengronghui/Documents/Apps/public/handbook/Golang/go-pprof-practice-master/animal/muridae/mouse/mouse.go\u003c/span\u003e\n    \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e50GB\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e1.\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e50GB\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e(flat,\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003ecum)\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e99.90\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e%\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eTotal\u003c/span\u003e\n         \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e          \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e     \u003cspan class=\"hljs-attr\"\u003e45:\u003c/span\u003e\n         \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e          \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e46\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e:func\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e(m\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e*Mouse)\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eSteal()\u003c/span\u003e {\n         \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e          \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e     \u003cspan class=\"hljs-attr\"\u003e47:\u003c/span\u003e\t\u003cspan class=\"hljs-string\"\u003elog.Println(m.Name()\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;steal\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e          \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e     \u003cspan class=\"hljs-attr\"\u003e48:\u003c/span\u003e\t\u003cspan class=\"hljs-string\"\u003emax\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e:=\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003econstant.Gi\u003c/span\u003e\n         \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e          \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e     \u003cspan class=\"hljs-attr\"\u003e49:\u003c/span\u003e\t\u003cspan class=\"hljs-string\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003elen(m.buffer)*constant.Mi\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003emax\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr\"\u003e1.50GB     1.50GB     50:\u003c/span\u003e\t\t\u003cspan class=\"hljs-string\"\u003em.buffer\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003eappend(m.buffer\u003c/span\u003e, [\u003cspan class=\"hljs-string\"\u003econstant.Mi\u003c/span\u003e]\u003cspan class=\"hljs-string\"\u003ebyte\u003c/span\u003e{}\u003cspan class=\"hljs-string\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e          \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e     \u003cspan class=\"hljs-attr\"\u003e51:\u003c/span\u003e\t}\n         \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e          \u003cspan class=\"hljs-string\"\u003e.\u003c/span\u003e     \u003cspan class=\"hljs-number\"\u003e52\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e:\u003c/span\u003e}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eåŒæ ·å¯ä»¥ä½¿ç”¨webå¯è§†åŒ–å±•ç¤º\u003c/p\u003e\n\u003ch2\u003eæ’æŸ¥é¢‘ç¹å†…å­˜å›æ”¶\u003c/h2\u003e\n\u003cp\u003eè·å–ç¨‹åºè¿è¡Œæ—¶çš„GCæ—¥å¿—\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003egc 1 @0.003s 7%: 0.022+2.1+0.002 ms clock, 0.18+1.1/1.9/3.0+0.019 ms cpu, 4-\u0026gt;4-\u0026gt;3 MB, 5 MB goal, 8 P\ngc 2 @0.018s 3%: 0.009+1.8+0.001 ms clock, 0.073+0.096/2.2/0.16+0.013 ms cpu, 7-\u0026gt;7-\u0026gt;6 MB, 8 MB goal, 8 P\ngc 3 @0.089s 0%: 0.022+0.92+0.013 ms clock, 0.17+0.095/1.0/0.75+0.10 ms cpu, 16-\u0026gt;16-\u0026gt;14 MB, 17 MB goal, 8 P\ngc 4 @0.489s 0%: 0.023+1.5+0.014 ms clock, 0.18+0/2.4/1.1+0.11 ms cpu, 29-\u0026gt;29-\u0026gt;15 MB, 30 MB goal, 8 P\ngc 1 @0.003s 1%: 0.013+0.55+0.002 ms clock, 0.013+0.22/0.17/0+0.002 ms cpu, 16-\u0026gt;16-\u0026gt;0 MB, 17 MB goal, 1 P\ngc 2 @3.020s 0%: 0.070+0.56+0.002 ms clock, 0.070+0.17/0.20/0+0.002 ms cpu, 16-\u0026gt;16-\u0026gt;0 MB, 17 MB goal, 1 P\ngc 3 @6.027s 0%: 0.15+0.98+0.003 ms clock, 0.15+0.36/0.36/0+0.003 ms cpu, 16-\u0026gt;16-\u0026gt;0 MB, 17 MB goal, 1 P\ngc 4 @9.034s 0%: 0.10+0.63+0.002 ms clock, 0.10+0.16/0.23/0+0.002 ms cpu, 16-\u0026gt;16-\u0026gt;0 MB, 17 MB goal, 1 P\ngc 5 @12.040s 0%: 0.070+0.53+0.002 ms clock, 0.070+0.23/0.19/0+0.002 ms cpu, 16-\u0026gt;16-\u0026gt;0 MB, 17 MB goal, 1 P\ngc 6 @15.047s 0%: 0.11+0.66+0.002 ms clock, 0.11+0.23/0.27/0+0.002 ms cpu, 16-\u0026gt;16-\u0026gt;0 MB, 17 MB goal, 1 P\n\u003c/code\u003e\u003c/pre\u003e\u003cimg src=\"/images/blogs/gc_info.png\" /\u003e\n\n\u003cp\u003eæ¯æ¬¡gcéƒ½ä»16MBé‡Šæ”¾åˆ°0MBï¼Œè¯´æ˜ç¨‹åºåœ¨ä¸æ–­çš„å£°æ˜ç„¶åé‡Šæ”¾å†…å­˜\u003c/p\u003e\n\u003cp\u003eæ¥ä¸‹æ¥ä½¿ç”¨ pprof æ’æŸ¥æ—¶ï¼Œæˆ‘ä»¬åœ¨ä¹çš„ä¸æ˜¯ä»€ä¹ˆåœ°æ–¹åœ¨å ç”¨å¤§é‡å†…å­˜ï¼Œè€Œæ˜¯ä»€ä¹ˆåœ°æ–¹åœ¨ä¸åœåœ°ç”³è¯·å†…\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ego tool pprof http://localhost:6060/debug/pprof/allocs\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003eæ’æŸ¥åç¨‹æ³„æ¼\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ego tool pprof http://localhost:6060/debug/pprof/goroutine\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eåŒæ ·ä½¿ç”¨topã€listã€webå³å¯å®šä½åˆ°\u003c/p\u003e\n\u003ch2\u003eæ’æŸ¥é”çš„äº‰ç”¨\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ego tool pprof http://localhost:6060/debug/pprof/mutex\u003c/code\u003e\u003c/p\u003e\n","frontMatter":{"readingTime":{"text":"21 min read","minutes":20.295,"time":1217700,"words":4059},"slug":"golangå·¥ç¨‹åŒ–æ€»è§ˆ","fileName":"golangå·¥ç¨‹åŒ–æ€»è§ˆ.md","title":"golangå·¥ç¨‹åŒ–çºµè§ˆ","date":"2022-07-03T00:00:00.000Z","tags":["Golang"],"draft":false,"summary":"golangå·¥ç¨‹åŒ–æ‰€ç”¨åˆ°çš„å·¥å…·æ¦‚è§ˆ"}},"prev":{"title":"go-zeroå¾®æœåŠ¡å®è·µ","date":"2022-06-20T00:00:00.000Z","tags":["å®è·µ","äº‘åŸç”Ÿ"],"draft":false,"summary":"å¾®æœåŠ¡ç®€ä»‹ä»¥åŠgo-zeroå¦‚ä½•è½åœ°","slug":"go-zeroå¾®æœåŠ¡å®è·µ"},"next":{"title":"å®¹å™¨ä¹‹é—´çš„ç½‘ç»œæ¨¡å¼","date":"2022-07-04T00:00:00.000Z","tags":["å®¹å™¨"],"draft":false,"summary":"å®¹å™¨ä¹‹é—´çš„ç½‘ç»œæ¨¡å¼ç®€ä»‹","slug":"å®¹å™¨ä¹‹é—´çš„ç½‘ç»œæ¨¡å¼"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["golangå·¥ç¨‹åŒ–æ€»è§ˆ"]},"buildId":"qwylQn0rAYfx_DG8FLkaO","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>